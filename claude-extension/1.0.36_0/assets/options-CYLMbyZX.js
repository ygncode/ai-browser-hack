import{d as e,a as s,M as t,s as a,i as n,e as o,g as r,N as i,O as l}from"./Main-iyJ1wi9k.js";import{r as c,j as d,S as x,R as m,g as u,s as h,l as g,m as p}from"./permissions-DQjjgS8V.js";import{P as f,i as b,a as j}from"./SentryService-JiT06VPa.js";import{u as v,a as y,X as N,m as M,L as w}from"./useNotifications-CbXeQbHW.js";import{T as k}from"./TasksTab-Be_gFnwg.js";
/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=e("bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]),_=e("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),C=e("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),E=({analytics:e})=>{const a=s(),[n,o]=c.useState("unknown"),[r,i]=c.useState(!1),[l,x]=c.useState(null),m=c.useCallback(async()=>{try{const e=await navigator.permissions.query({name:"microphone"});o(e.state),e.addEventListener("change",()=>{o(e.state)})}catch(e){o("unknown")}},[]);c.useEffect(()=>{m()},[m]);const u=()=>{chrome.tabs.create({url:`chrome://settings/content/siteDetails?site=chrome-extension://${chrome.runtime.id}`})};return d.jsxs("div",{className:"bg-bg-100 border border-border-300 rounded-xl px-6 pt-6 pb-6 md:px-8 md:pt-8 md:pb-8",children:[d.jsx("h3",{className:"text-text-100 font-xl-bold",children:d.jsx(t,{defaultMessage:"Microphone",id:"cW6887Dc/X"})}),d.jsx("p",{className:"text-text-300 font-base mt-2 mb-6",children:d.jsx(t,{defaultMessage:"Enable microphone access to use your browser's speech-to-text functionality for voice narration during workflow recording",id:"2n9PvXg1wT"})}),d.jsxs("div",{className:"py-4",children:[("prompt"===n||"unknown"===n)&&d.jsxs("div",{children:[d.jsx("button",{onClick:async()=>{i(!0),x(null);try{(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(e=>e.stop()),await m(),e?.track("claude_chrome.settings.microphone_enabled",{timestamp:Date.now()})}catch(s){s instanceof DOMException?"NotAllowedError"===s.name?x(a.formatMessage({defaultMessage:"Permission denied. You can change this in your browser settings.",id:"ErBqL1OKdE"})):"NotFoundError"===s.name?x(a.formatMessage({defaultMessage:"No microphone found. Please connect a microphone and try again.",id:"KAhM8UkR3A"})):x(a.formatMessage({defaultMessage:"Error: {errorMessage}",id:"Q+J7H4sPgD"},{errorMessage:s.message})):s instanceof Error?x(a.formatMessage({defaultMessage:"Error: {errorMessage}",id:"Q+J7H4sPgD"},{errorMessage:s.message})):x(a.formatMessage({defaultMessage:"An unknown error occurred",id:"3VG8rbxa4v"})),await m()}finally{i(!1)}},disabled:r,className:"px-6 py-2.5 bg-accent-main-100 text-oncolor-100 rounded-lg hover:bg-accent-main-100/90 transition-all font-base disabled:opacity-50 disabled:cursor-not-allowed",children:r?d.jsx(t,{defaultMessage:"Requesting...",id:"Gma+ACm5J+"}):d.jsx(t,{defaultMessage:"Allow Microphone Access",id:"JfUPjhqwuq"})}),l&&d.jsx("div",{className:"mt-3 px-4 py-3 bg-danger-000/10 border border-danger-000/20 rounded-lg",children:d.jsx("p",{className:"font-base text-danger-000",children:l})})]}),"granted"===n&&d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx("div",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-success-100 flex items-center justify-center mt-0.5",children:d.jsx("svg",{className:"w-3 h-3 text-oncolor-100",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{d:"M5 13l4 4L19 7"})})}),d.jsxs("div",{children:[d.jsx("div",{className:"font-large text-text-100",children:d.jsx(t,{defaultMessage:"Microphone access granted",id:"Ymx8APRi1X"})}),d.jsx("div",{className:"text-text-400 font-base-sm mt-1",children:d.jsx(t,{defaultMessage:"You can now use voice narration when recording workflows. To disable, go to {chromeSettingsLink}.",id:"NSJdoMrS0C",values:{chromeSettingsLink:d.jsx("button",{onClick:u,className:"text-accent-main-100 hover:underline cursor-pointer",children:d.jsx(t,{defaultMessage:"Chrome settings",id:"jebWZltnsn"})})}})})]})]}),"denied"===n&&d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx("div",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-danger-200 flex items-center justify-center mt-0.5",children:d.jsx("svg",{className:"w-3 h-3 text-danger-000",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})}),d.jsxs("div",{children:[d.jsx("div",{className:"font-large text-text-100",children:d.jsx(t,{defaultMessage:"Microphone access blocked",id:"13YOiAKDfM"})}),d.jsx("div",{className:"text-text-400 font-base-sm mt-1",children:d.jsx(t,{defaultMessage:"Microphone access has been denied. To enable, change Microphone to 'Allow' in {chromeSettingsLink}.",id:"5SGbHZD5HC",values:{chromeSettingsLink:d.jsx("button",{onClick:u,className:"text-accent-main-100 hover:underline cursor-pointer",children:d.jsx(t,{defaultMessage:"Chrome settings",id:"jebWZltnsn"})})}})})]})]})]})]})},T=()=>{const e=s(),[o,r]=c.useState(),[i,l]=c.useState(!0),[m,u]=v(x.NOTIFICATIONS_ENABLED,void 0),{value:h}=a.useFeatureGate("crochet_can_skip_permissions"),{value:g}=a.useFeatureGate("chrome_ext_record_workflow"),{analytics:p}=n(),b=c.useMemo(()=>new f(()=>!1),[]);c.useEffect(()=>{b.setCanSkipPermissions(h)},[h,b]);const j=c.useCallback(async()=>{l(!0);try{await b.loadPermissions();const e=b.getPermissionsByScope();r({netloc:e.netloc.filter(e=>!e.toolUseId),domain_transition:e.domain_transition.filter(e=>!e.toolUseId)})}catch(e){}finally{l(!1)}},[b]);c.useEffect(()=>{j()},[j]);const y=async e=>{await b.revokePermission(e),j()},N=s=>"domain_transition"===s.scope.type?`${s.scope.fromDomain} â†’ ${s.scope.toDomain}`:s.scope.netloc||e.formatMessage({defaultMessage:"Unknown domain",id:"FMvJL9TokP"});return i?d.jsx("div",{className:"p-6 text-text-200",children:d.jsx(t,{defaultMessage:"Loading permissions...",id:"481hO7jC9z"})}):d.jsx("div",{className:"permissions-tab",children:d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"bg-bg-100 border border-border-300 rounded-xl px-6 pt-6 pb-6 md:px-8 md:pt-8 md:pb-8",children:[d.jsx("h3",{className:"text-text-100 font-xl-bold",children:d.jsx(t,{defaultMessage:"Notifications",id:"NAidKbB0vi"})}),d.jsx("p",{className:"text-text-300 font-base mt-2 mb-6",children:d.jsx(t,{defaultMessage:"Get notified when tasks complete or need your input",id:"YxhKVgP/H4"})}),d.jsxs("div",{className:"flex items-center justify-between py-4",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("div",{className:"font-large text-text-100",children:d.jsx(t,{defaultMessage:"Task completion notifications",id:"u18BzaOjgu"})}),d.jsx("div",{className:"text-text-400 font-base-sm mt-1",children:"enabled"===m?d.jsx(t,{defaultMessage:"You'll receive notifications when tasks finish",id:"fhFmwPnm6J"}):"disabled"===m?d.jsx(t,{defaultMessage:"Notifications are turned off",id:"GzejKCwLFI"}):d.jsx(t,{defaultMessage:"You haven't set your notification preference yet",id:"Dh7mYgVZea"})})]}),d.jsxs("label",{className:"relative inline-flex items-center cursor-pointer ml-4",children:[d.jsx("input",{type:"checkbox",className:"sr-only peer",checked:"enabled"===m,onChange:e=>(async e=>{const s=e?"enabled":"disabled";await u(s)})(e.target.checked)}),d.jsx("div",{className:"w-11 h-6 bg-bg-300 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-accent-secondary-100 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-border-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-secondary-100"})]})]})]}),g&&d.jsx(E,{analytics:p}),d.jsxs("div",{className:"bg-bg-100 border border-border-300 rounded-xl px-6 pt-6 pb-2 md:px-8 md:pt-8 md:pb-3",children:[d.jsx("h3",{className:"text-text-100 font-xl-bold",children:d.jsx(t,{defaultMessage:"Your approved sites",id:"NFf/0A3zf+"})}),d.jsx("p",{className:"text-text-300 font-base mt-2 mb-6",children:d.jsx(t,{defaultMessage:"You have allowed Claude to take all actions (browse, click, type) on these sites.",id:"7W74V502ms"})}),o?.netloc&&o.netloc.length>0?d.jsx(P,{permissions:o.netloc,onRevoke:y,formatScope:N}):d.jsx("div",{className:"text-text-400 font-base-sm pb-5",children:d.jsx(t,{defaultMessage:"No sites have been approved yet",id:"B2ROp8L071"})})]}),o?.domain_transition&&o.domain_transition.length>0&&d.jsxs("div",{className:"bg-bg-100 border border-border-300 rounded-xl px-6 pt-6 pb-2 md:px-8 md:pt-8 md:pb-3",children:[d.jsx("h3",{className:"text-text-100 font-xl-bold",children:d.jsx(t,{defaultMessage:"Domain Transitions",id:"uYztQwXf/+"})}),d.jsx("p",{className:"text-text-300 font-base mt-2 mb-6",children:d.jsx(t,{defaultMessage:"Permissions for navigating between different domains.",id:"fxDu88cBut"})}),d.jsx(A,{permissions:o.domain_transition,onRevoke:y,formatScope:N})]})]})})},P=({permissions:e,onRevoke:s,formatScope:a})=>d.jsx("div",{children:e.map((n,o)=>d.jsxs(m.Fragment,{children:[d.jsxs("div",{className:"py-4 flex items-center justify-between",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("div",{className:"font-large text-text-100",children:a(n)}),n.lastUsed&&d.jsx("div",{className:"text-xs text-text-400 mt-1",children:d.jsx(t,{defaultMessage:"Last used: {date}",id:"VbVJvDFrU4",values:{date:new Date(n.lastUsed).toLocaleString()}})})]}),d.jsx("button",{onClick:()=>s(n.id),className:"ml-4 px-4 py-2 text-danger-000 hover:bg-danger-000/10 rounded-lg transition-all font-base",children:d.jsx(t,{defaultMessage:"Revoke",id:"tnRDuUFRQw"})})]}),o<e.length-1&&d.jsx("div",{className:"border-b border-border-400"})]},n.id))}),A=({permissions:e,onRevoke:s,formatScope:a})=>d.jsx("div",{children:e.map((n,o)=>d.jsxs(m.Fragment,{children:[d.jsxs("div",{className:"py-4 flex items-center justify-between",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("div",{className:"font-large text-text-100",children:a(n)}),n.lastUsed&&d.jsx("div",{className:"text-xs text-text-400 mt-1",children:d.jsx(t,{defaultMessage:"Last used: {date}",id:"VbVJvDFrU4",values:{date:new Date(n.lastUsed).toLocaleString()}})})]}),d.jsx("button",{onClick:()=>s(n.id),className:"ml-4 px-4 py-2 text-danger-000 hover:bg-danger-000/10 rounded-lg transition-all font-base",children:d.jsx(t,{defaultMessage:"Revoke",id:"tnRDuUFRQw"})})]}),o<e.length-1&&d.jsx("div",{className:"border-b border-border-400"})]},n.id))}),R=({apiKey:e,setApiKey:a,onSave:n,saved:o})=>{const r=s();return d.jsxs("div",{className:"max-w-md",children:[d.jsx("h2",{className:"font-xl-bold text-text-100 mb-4",children:d.jsx(t,{defaultMessage:"API configuration (internal)",id:"FHNYsg5qSG"})}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"apiKey",className:"font-label block mb-2 text-text-200",children:d.jsx(t,{defaultMessage:"Anthropic API Key",id:"2H4p4zLO4P"})}),d.jsx("input",{id:"apiKey",type:"password",value:e,onChange:e=>a(e.target.value),placeholder:r.formatMessage({defaultMessage:"Enter your Anthropic API key",id:"CnmTFdmsRf"}),className:"w-full px-3 py-2 border border-border-200 rounded-md focus:outline-none focus:ring-2 focus:ring-accent-main-200 bg-bg-000 text-text-100 font-base"}),d.jsx("p",{className:"mt-2 font-caption text-text-300",children:d.jsx(t,{defaultMessage:"Get your API key from {link}",id:"IB3vNKlUdQ",values:{link:d.jsx("a",{href:"https://console.anthropic.com/account/keys",target:"_blank",rel:"noopener noreferrer",className:"inline-link hover:text-accent-main-100",children:d.jsx(t,{defaultMessage:"console.anthropic.com",id:"b8BNfDaOsb"})})}})})]}),d.jsx("button",{onClick:n,className:"w-full bg-accent-main-200 text-oncolor-100 py-2 px-4 rounded-md hover:bg-accent-main-100 focus:outline-none focus:ring-2 focus:ring-accent-main-200 font-button-lg",children:d.jsx(t,{defaultMessage:"Save API Key",id:"0BMfJOry+3"})}),o&&d.jsx("div",{className:"font-base-sm text-text-200",children:d.jsx(t,{defaultMessage:"Settings saved.",id:"IKoTMcBJ0H"})})]})]})},D=({systemPrompt:e,setSystemPrompt:a,debugMode:n,setDebugMode:o,onPromptSave:r,onResetPrompt:i,saved:l,setSaved:m,allowEditSystemPrompt:g})=>{const p=s(),[f,b]=c.useState(!1),[j,v]=c.useState(!1);c.useEffect(()=>{u(x.SHOW_TRACE_IDS).then(e=>{void 0!==e&&b(e)})},[]),c.useEffect(()=>{u(x.SHOW_SYSTEM_REMINDERS).then(e=>{void 0!==e&&v(e)})},[]);return d.jsx("div",{className:"max-w-2xl",children:d.jsxs("div",{className:"space-y-6",children:[g&&d.jsxs("div",{className:"space-y-4",children:[d.jsx("h3",{className:"font-large-bold text-text-100",children:d.jsx(t,{defaultMessage:"System Prompt",id:"BwIZY+bHrv"})}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"systemPrompt",className:"font-label block mb-2 text-text-200",children:d.jsx(t,{defaultMessage:"Customize System Prompt",id:"zi3F37/OAt"})}),d.jsx("textarea",{id:"systemPrompt",value:e,onChange:e=>a(e.target.value),placeholder:p.formatMessage({defaultMessage:"Enter custom system prompt...",id:"TXMFQQmX1y"}),className:"w-full px-3 py-2 border border-border-200 rounded-md focus:outline-none focus:ring-2 focus:ring-accent-main-200 font-code bg-bg-000 text-text-100",rows:12}),d.jsx("p",{className:"mt-2 font-caption text-text-300",children:d.jsx(t,{defaultMessage:"Customize the instructions given to Claude for browser automation tasks.",id:"4AhXwwJN7S"})})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsx("button",{onClick:r,className:"flex-1 bg-accent-main-200 text-oncolor-100 py-2 px-4 rounded-md hover:bg-accent-main-300 focus:outline-none focus:ring-2 focus:ring-accent-main-200 font-button-lg",children:d.jsx(t,{defaultMessage:"Save System Prompt",id:"T6BjuHu60u"})}),d.jsx("button",{onClick:i,className:"px-4 py-2 border border-border-200 rounded-md hover:bg-bg-200 focus:outline-none focus:ring-2 focus:ring-border-100 text-text-200 font-button",children:d.jsx(t,{defaultMessage:"Reset to Default",id:"ZGgOeVIR/y"})})]})]}),d.jsx("div",{className:"border-t border-border-300"}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("h3",{className:"font-large-bold text-text-100 flex items-center gap-2",children:[d.jsx(S,{className:"w-5 h-5"}),d.jsx(t,{defaultMessage:"(Ant-only) Debug Settings",id:"SjBgp+EBYt"})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[d.jsx("input",{type:"checkbox",checked:n,onChange:e=>(async e=>{o(e),await h(x.DEBUG_MODE,e),m(!0),setTimeout(()=>m(!1),2e3)})(e.target.checked),className:"w-4 h-4 text-accent-secondary-200 bg-bg-000 border-border-200 rounded focus:ring-accent-secondary-200 focus:ring-2"}),d.jsxs("div",{children:[d.jsx("p",{className:"font-base text-text-100",children:d.jsx(t,{defaultMessage:"Show tool result details",id:"NtMBSeGOHp"})}),d.jsx("p",{className:"font-caption text-text-300",children:d.jsx(t,{defaultMessage:"Enable expandable tool result blocks to view parameters and outputs",id:"o8XuRD97nP"})})]})]}),d.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[d.jsx("input",{type:"checkbox",checked:f,onChange:e=>(async e=>{b(e),await h(x.SHOW_TRACE_IDS,e),m(!0),setTimeout(()=>m(!1),2e3)})(e.target.checked),className:"w-4 h-4 text-accent-secondary-200 bg-bg-000 border-border-200 rounded focus:ring-accent-secondary-200 focus:ring-2"}),d.jsxs("div",{children:[d.jsx("p",{className:"font-base text-text-100",children:d.jsx(t,{defaultMessage:"Show trace IDs",id:"438y6E4IUP"})}),d.jsx("p",{className:"font-caption text-text-300",children:d.jsx(t,{defaultMessage:"Display trace IDs at the beginning of each response stream",id:"lMdXZI/U+s"})})]})]}),d.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[d.jsx("input",{type:"checkbox",checked:j,onChange:e=>(async e=>{v(e),await h(x.SHOW_SYSTEM_REMINDERS,e),m(!0),setTimeout(()=>m(!1),2e3)})(e.target.checked),className:"w-4 h-4 text-accent-secondary-200 bg-bg-000 border-border-200 rounded focus:ring-accent-secondary-200 focus:ring-2"}),d.jsxs("div",{children:[d.jsx("p",{className:"font-base text-text-100",children:d.jsx(t,{defaultMessage:"Show system reminders",id:"omhQimAye8"})}),d.jsx("p",{className:"font-caption text-text-300",children:d.jsx(t,{defaultMessage:"Display system reminder tags for debugging tab context changes",id:"yx1UefClU6"})})]})]})]})]}),l&&d.jsx("div",{className:"font-base-sm text-text-200",children:d.jsx(t,{defaultMessage:"Settings saved.",id:"IKoTMcBJ0H"})})]})})},I=()=>{const e=s(),[a,n]=c.useState(""),{sendNotification:o}=y(),r=m.useRef(null);m.useEffect(()=>()=>{r.current&&clearTimeout(r.current)},[]);const i=(e,s,t)=>({role:"assistant",content:e,id:`msg_staging_${Math.random().toString(36).substring(2,11)}`,model:"claude-sonnet-4-20250514",stop_reason:t?"tool_use":"end_turn",stop_sequence:null,type:"message",usage:{input_tokens:s.input,output_tokens:s.output,cache_creation_input_tokens:s.cacheCreation||0,cache_read_input_tokens:s.cacheRead||0}}),l=async(s,t)=>{try{await h(x.TEST_DATA_MESSAGES,t),n(e.formatMessage({defaultMessage:"Loaded {scenarioName} - Reload the side panel to use",id:"a5aJshKbyM"},{scenarioName:s})),r.current&&clearTimeout(r.current),r.current=setTimeout(()=>n(""),3e3)}catch(a){n(e.formatMessage({defaultMessage:"Error loading test data: {error}",id:"oG042zasXb"},{error:String(a)}))}};return d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-lg font-medium text-text-100 mb-4",children:d.jsx(t,{defaultMessage:"Development testing tools",id:"Luu9/7cA+i"})}),d.jsx("p",{className:"text-sm text-text-300 mb-6",children:d.jsx(t,{defaultMessage:"Tools for testing and debugging the extension during development.",id:"caw/dieQFJ"})})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("h3",{className:"text-md font-medium text-text-100 mb-3",children:d.jsx(t,{defaultMessage:"Test conversations",id:"5cTjpUYBW8"})}),d.jsxs("div",{className:"flex flex-wrap gap-3",children:[d.jsx("button",{onClick:()=>{const e=[{role:"user",content:[{type:"text",text:"what's on the screen?"}]},i([{type:"text",text:"I'll take a screenshot to see what's currently on the screen."}],{input:147,output:66,cacheCreation:10234})];l("Simple Conversation",e)},className:"px-4 py-2 bg-accent-main-100 text-oncolor-100 rounded hover:bg-accent-main-200 transition-colors",children:d.jsx(t,{defaultMessage:"Load simple conversation",id:"4jbxHKfdQJ"})}),d.jsx("button",{onClick:()=>{const e=[];for(let s=0;s<50;s++)e.push({role:"user",content:[{type:"text",text:`Question ${s+1}: Tell me about item ${s+1}`}]}),e.push(i([{type:"text",text:`Here's information about item ${s+1}. `.repeat(50)}],{input:2e3+100*s,output:500,cacheRead:1e3}));l("Long Conversation",e)},className:"px-4 py-2 bg-accent-main-100 text-oncolor-100 rounded hover:bg-accent-main-200 transition-colors",children:d.jsx(t,{defaultMessage:"Load long conversation",id:"lzq8R0x4iG"})}),d.jsx("button",{onClick:()=>{const e=[],s="This is a test message that simulates a long conversation. ".repeat(1e3),t=Math.floor(72e4/(2*s.length));for(let n=0;n<t;n++)e.push({role:"user",content:[{type:"text",text:`Question ${n+1}: ${s}`}]}),e.push(i([{type:"text",text:`Response ${n+1}: ${s}`}],{input:1e4+500*n,output:5e3+100*n,cacheRead:2e3}));const a=e[e.length-1];a&&"usage"in a&&a.usage&&(a.usage.input_tokens=10,a.usage.cache_creation_input_tokens=15e4,a.usage.cache_read_input_tokens=3e4,a.usage.output_tokens=5e3),l("Near Context Limit",e)},className:"px-4 py-2 bg-accent-main-100 text-oncolor-100 rounded hover:bg-accent-main-200 transition-colors",children:d.jsx(t,{defaultMessage:"Load near context limit",id:"iWwS2NQh2N"})}),d.jsx("button",{onClick:()=>{const e=[{role:"user",content:[{type:"text",text:"Navigate to google.com and search for 'weather'"}]},i([{type:"text",text:"I'll navigate to Google and search for weather information."},{type:"tool_use",id:"toolu_01_navigate",name:"navigate",input:{url:"https://google.com"}}],{input:200,output:100,cacheCreation:5e3},!0),{role:"user",content:[{type:"tool_result",tool_use_id:"toolu_01_navigate",content:"Navigated to google.com"}]},i([{type:"text",text:"Now I'll search for 'weather' on Google."},{type:"tool_use",id:"toolu_02_type",name:"computer",input:{action:"type",text:"weather"}}],{input:300,output:150,cacheRead:4e3},!0)];l("Tool Use Conversation",e)},className:"px-4 py-2 bg-accent-main-100 text-oncolor-100 rounded hover:bg-accent-main-200 transition-colors",children:d.jsx(t,{defaultMessage:"Load tool use conversation",id:"rdQw3nhjJl"})}),d.jsx("button",{onClick:async()=>{try{await chrome.storage.local.remove("test_data_messages"),n(e.formatMessage({defaultMessage:"Test data cleared",id:"ZRHK60/fN5"})),r.current&&clearTimeout(r.current),r.current=setTimeout(()=>n(""),3e3)}catch(s){n(e.formatMessage({defaultMessage:"Error clearing test data: {error}",id:"UltGDMwKAE"},{error:String(s)}))}},className:"px-4 py-2 bg-danger-100 text-oncolor-100 rounded hover:bg-danger-200 transition-colors",children:d.jsx(t,{defaultMessage:"Clear test data",id:"PecM9GAXxD"})})]})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("h3",{className:"text-md font-medium text-text-100 mb-3",children:d.jsx(t,{defaultMessage:"Test notifications",id:"3KbdFvbeRu"})}),d.jsxs("div",{className:"flex flex-wrap gap-3",children:[d.jsx("button",{onClick:()=>{o({title:e.formatMessage({defaultMessage:"Claude had to pause",id:"x8JhFG5A3f"}),body:e.formatMessage({defaultMessage:"Your permission is needed to continue",id:"qEqMmrx/MW"})}),n(e.formatMessage({defaultMessage:"Sent permission notification",id:"83rtGTKgfN"})),r.current&&clearTimeout(r.current),r.current=setTimeout(()=>n(""),3e3)},className:"px-4 py-2 bg-accent-secondary-100 text-oncolor-100 rounded hover:bg-accent-secondary-200 transition-colors",children:d.jsx(t,{defaultMessage:"Test permission notification",id:"RhGz0PXZQn"})}),d.jsx("button",{onClick:()=>{o({title:e.formatMessage({defaultMessage:"Claude is done",id:"pnrK9Ss/bt"}),body:e.formatMessage({defaultMessage:"Your task is completed. Ready to check in?",id:"dXUR4BjgcC"})}),n(e.formatMessage({defaultMessage:"Sent completion notification",id:"vELHSm4csV"})),r.current&&clearTimeout(r.current),r.current=setTimeout(()=>n(""),3e3)},className:"px-4 py-2 bg-accent-secondary-100 text-oncolor-100 rounded hover:bg-accent-secondary-200 transition-colors",children:d.jsx(t,{defaultMessage:"Test completion notification",id:"B9+OriKQKb"})})]}),a&&d.jsx("div",{className:"mt-4 p-3 bg-bg-200 rounded text-sm text-text-200",children:a})]}),d.jsxs("div",{className:"mt-6 p-4 bg-bg-200 rounded",children:[d.jsx("h3",{className:"text-sm font-medium text-text-200 mb-2",children:d.jsx(t,{defaultMessage:"How it works:",id:"ON3IdRBcc4"})}),d.jsxs("ul",{className:"text-sm text-text-300 space-y-1",children:[d.jsx("li",{children:d.jsx(t,{defaultMessage:"Test data is saved to chrome.storage.local",id:"JdFy/2Te9C"})}),d.jsx("li",{children:d.jsx(t,{defaultMessage:"The side panel reads this data on initialization",id:"hZDjbuZQlF"})}),d.jsx("li",{children:d.jsx(t,{defaultMessage:"No direct manipulation of message state",id:"BAeUW3tSiP"})}),d.jsx("li",{children:d.jsx(t,{defaultMessage:"Reload the side panel after loading test data",id:"wQ9MRHcGCI"})})]})]})]})},F=({isOpen:e,returnTabId:a,onClose:n})=>{const o=s(),[r,i]=c.useState("unknown"),[l,x]=c.useState(!1),[m,u]=c.useState(null),[h,g]=c.useState(!1),p=c.useCallback(()=>{g(!0),a?chrome.tabs.update(a,{active:!0},()=>{chrome.tabs.getCurrent(e=>{e?.id&&chrome.tabs.remove(e.id)})}):chrome.tabs.getCurrent(e=>{e?.id&&chrome.tabs.remove(e.id)})},[a]),f=c.useCallback(async()=>{try{const e=await navigator.permissions.query({name:"microphone"});i(e.state),e.addEventListener("change",()=>{const s=e.state;i(s),"granted"===s&&p()})}catch(e){i("unknown")}},[p]);c.useEffect(()=>{e&&f()},[e,f]);const b=()=>{n()};return e?d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 transition-opacity duration-200 "+(h?"opacity-0":"opacity-100"),children:d.jsxs("div",{className:"bg-bg-000 rounded-2xl shadow-xl max-w-md w-full mx-4 transform transition-all duration-200 "+(h?"scale-95 opacity-0":"scale-100 opacity-100"),children:[d.jsxs("div",{className:"flex items-center justify-between px-6 pt-6",children:[d.jsx("div",{className:"w-8"})," ",d.jsx("button",{onClick:b,className:"p-2 rounded-lg hover:bg-bg-200 transition-colors","aria-label":o.formatMessage({defaultMessage:"Close",id:"rbrahOGMC3"}),children:d.jsx(N,{size:16,className:"text-text-300"})})]}),d.jsxs("div",{className:"px-6 pb-6 pt-2 text-center",children:[d.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-accent-main-100/10 flex items-center justify-center",children:d.jsx(M,{size:32,weight:"fill",className:"text-accent-main-100"})}),d.jsx("h2",{className:"font-xl-bold text-text-100 mb-2",children:d.jsx(t,{defaultMessage:"Enable microphone access",id:"StB9n+uYO4"})}),d.jsx("p",{className:"text-text-300 font-base mb-6",children:d.jsx(t,{defaultMessage:"Claude needs microphone access to hear your voice narration while you demonstrate workflows. When prompted, select <strong>Allow while visiting the site</strong> to enable voice narration.",id:"C8CF1Igl7Q",values:{strong:e=>d.jsx("span",{className:"font-semibold text-text-200",children:e})}})}),"granted"===r?d.jsxs("div",{className:"mb-6 p-4 bg-success-100/10 border border-success-100/20 rounded-xl",children:[d.jsxs("div",{className:"flex items-center justify-center gap-2 text-success-100",children:[d.jsx("svg",{className:"w-5 h-5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{d:"M5 13l4 4L19 7"})}),d.jsx("span",{className:"font-large",children:d.jsx(t,{defaultMessage:"Microphone access granted",id:"Ymx8APRi1X"})})]}),d.jsx("p",{className:"text-text-300 font-base-sm mt-2",children:d.jsx(t,{defaultMessage:"Returning to your workflow...",id:"BHzoQdwFnu"})})]}):"denied"===r?d.jsx("div",{className:"mb-6 p-4 bg-danger-000/10 border border-danger-000/20 rounded-xl",children:d.jsx("p",{className:"font-base text-danger-000",children:d.jsx(t,{defaultMessage:"Microphone access was denied. You can either try again or <link>open Chrome settings</link> to enable microphone access.",id:"e2DtORRpyx",values:{link:e=>d.jsx("button",{onClick:()=>{const e=`chrome://settings/content/siteDetails?site=chrome-extension%3A%2F%2F${chrome.runtime.id}%2F`;chrome.tabs.create({url:e})},className:"underline hover:no-underline",children:e})}})})}):null,m&&d.jsx("div",{className:"mb-6 p-4 bg-danger-000/10 border border-danger-000/20 rounded-xl",children:d.jsx("p",{className:"font-base text-danger-000",children:m})}),"granted"!==r&&"denied"!==r&&d.jsxs("button",{onClick:async()=>{x(!0),u(null);try{(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(e=>e.stop());"granted"===(await navigator.permissions.query({name:"microphone"})).state?p():(x(!1),u('You selected "Allow this time" which doesn\'t persist. Please click the button again and select "Allow while visiting the site" to enable voice narration.'))}catch(e){x(!1),e instanceof DOMException?"NotAllowedError"===e.name?await f():"NotFoundError"===e.name?u("No microphone found. Please connect a microphone and try again."):u(`Error: ${e.message}`):e instanceof Error?u(`Error: ${e.message}`):u("An unknown error occurred")}},disabled:l,className:"w-full px-6 py-3 bg-accent-main-100 text-oncolor-100 rounded-xl hover:bg-accent-main-100/90 transition-all font-large disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[d.jsx(M,{size:20,weight:"fill"}),l?d.jsx(t,{defaultMessage:"Requesting access...",id:"kDYzre2KOj"}):d.jsx(t,{defaultMessage:"Allow microphone access",id:"83itGujdwB"})]}),d.jsx("button",{onClick:b,className:"mt-4 text-text-300 hover:text-text-200 font-base-sm transition-colors",children:d.jsx(t,{defaultMessage:"Skip for now",id:"WYzHAIKZxl"})})]})]})}):null},L=({children:e,isActive:s,onClick:t})=>d.jsx("button",{onClick:t,className:o("block w-full text-left whitespace-nowrap transition-all ease-in-out active:scale-95 cursor-pointer","font-base rounded-lg px-3 py-3",s?"bg-bg-300 font-medium text-text-000":"text-text-200 hover:bg-bg-200 hover:text-text-100"),children:e}),O=({children:e,className:s,narrow:t})=>d.jsx("main",{className:o("mx-auto mt-4 w-full flex-1 px-4 md:pl-8 lg:mt-6",t?"max-w-4xl":"max-w-7xl",s),children:e}),Y=({children:e,className:s,contentClassName:t,sticky:a,fixed:n,mdTitle:r,large:i,narrow:l})=>{const c=!e&&!r,x=i;return d.jsx("header",{className:o("flex w-full bg-bg-100",a&&"sticky top-0 z-header",n&&"fixed top-0 z-header","h-12",x&&["mx-auto md:h-24 md:items-end",l?"max-w-4xl":"max-w-7xl"],s),"aria-hidden":c,children:d.jsx("div",{className:o("flex w-full items-center justify-between gap-4","pl-11 lg:pl-8",t,x?"px-4 md:pl-8":"pr-3"),children:r?d.jsxs(d.Fragment,{children:[d.jsx("h1",{className:o("text-text-200 flex items-center gap-2 max-md:hidden min-w-0","font-heading",x?"text-2xl":"text-lg"),children:d.jsx("span",{className:"truncate",children:r})}),d.jsx("div",{}),e]}):e})})};function B(){const{userProfile:e,isAuthenticated:s}=r(),{resetAnalytics:o}=n(),{value:i}=a.useFeatureGate("chrome_extension_show_user_email"),{value:l}=a.useFeatureGate("crochet_default_debug_mode"),{value:m}=a.useFeatureGate("chrome_ext_allow_api_key"),{value:u}=a.useFeatureGate("chrome_ext_edit_system_prompt"),[f,b]=c.useState(""),[j,v]=c.useState(!1),[y,N]=c.useState("permissions"),[M,S]=c.useState(""),[E,P]=c.useState(!1),[A,B]=c.useState(!1),[G,H]=c.useState();c.useEffect(()=>{g([x.ANTHROPIC_API_KEY,x.SYSTEM_PROMPT,x.DEBUG_MODE]).then(e=>{e[x.ANTHROPIC_API_KEY]&&b(e[x.ANTHROPIC_API_KEY]),e[x.SYSTEM_PROMPT]&&S(e[x.SYSTEM_PROMPT]),void 0!==e[x.DEBUG_MODE]?P(e[x.DEBUG_MODE]):P(l||!1)})},[l]),c.useEffect(()=>{const e=()=>{const e=window.location.hash.slice(1),[s,t]=e.split("?"),a=["api","permissions","model","prompts","testdata"].includes(s)?s:"permissions";let n,o=!1;if(t){const e=new URLSearchParams(t);o="true"===e.get("requestMicrophone");const s=e.get("returnTabId");s&&(n=parseInt(s,10))}return{tab:a,requestMicrophone:o,returnTabId:n}},s=()=>{const{tab:s,requestMicrophone:t,returnTabId:a}=e();N(s),t&&(B(!0),H(a))},{tab:t,requestMicrophone:a,returnTabId:n}=e();return N(t),a&&(B(!0),H(n)),window.addEventListener("hashchange",s),()=>{window.removeEventListener("hashchange",s)}},[]);const K=e=>{N(e),window.location.hash=e};return d.jsxs("div",{"data-theme":"claude",children:[d.jsxs(Y,{large:!0,mdTitle:s||f?d.jsx("div",{className:"flex flex-col pl-3",children:d.jsx("span",{children:d.jsx(t,{defaultMessage:"Claude in Chrome settings",id:"eDHTgRaIJG"})})}):void 0,sticky:!0,children:[s&&e&&i&&d.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-bg-000 border border-border-200 rounded-lg",children:[d.jsx(C,{className:"w-4 h-4 text-text-300"}),d.jsx("span",{className:"font-base-sm text-text-200",children:e.account.email})]}),!s&&f&&d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-bg-000 border border-border-200 rounded-lg",children:[d.jsx(C,{className:"w-4 h-4 text-text-300"}),d.jsx("span",{className:"font-base-sm text-text-200",children:d.jsx(t,{defaultMessage:"API Key Mode",id:"5oZeuus9Dz"})})]}),d.jsx("button",{onClick:async()=>{try{await p()}catch(e){}},className:"px-3 py-2 bg-accent-main-100 text-oncolor-100 rounded-lg font-base-sm hover:bg-accent-main-200 transition-colors",children:d.jsx(t,{defaultMessage:"Login",id:"AyGauyc55S"})})]})]}),d.jsxs(O,{children:[d.jsx("div",{className:"mb-4 md:hidden pl-3",children:d.jsx("h1",{className:"font-heading text-text-200 flex items-center gap-1.5",children:d.jsx(t,{defaultMessage:"Settings",id:"D3idYvSLF9"})})}),s||f?d.jsxs("div",{className:"grid md:grid-cols-[220px_minmax(0px,_1fr)] gap-x-8 w-full max-w-6xl my-4 md:my-8",children:[d.jsxs("nav",{className:"w-full overflow-x-auto -m-2 p-2 self-start md:sticky md:top-4 relative z-10 mb-4 md:mb-0",children:[d.jsxs("ul",{className:"flex gap-1 md:flex-col mb-0",children:[m&&d.jsx("li",{children:d.jsx(L,{href:"/settings/api",isActive:"api"===y,onClick:()=>K("api"),children:d.jsx(t,{defaultMessage:"API configuration (internal)",id:"FHNYsg5qSG"})})}),m&&d.jsx("li",{children:d.jsx(L,{href:"/settings/model",isActive:"model"===y,onClick:()=>K("model"),children:d.jsx(t,{defaultMessage:"Model selection (internal)",id:"0Wg9mEmibC"})})}),d.jsx("li",{children:d.jsx(L,{href:"/settings/permissions",isActive:"permissions"===y,onClick:()=>K("permissions"),children:d.jsx(t,{defaultMessage:"Permissions",id:"SFuk1vRI4X"})})}),d.jsx("li",{children:d.jsx(L,{href:"/settings/prompts",isActive:"prompts"===y,onClick:()=>K("prompts"),children:d.jsx(t,{defaultMessage:"Shortcuts",id:"7FAwwkYilD"})})}),m&&d.jsx("li",{children:d.jsx(L,{href:"/settings/testdata",isActive:"testdata"===y,onClick:()=>K("testdata"),children:d.jsx(t,{defaultMessage:"Dev Testing (Internal)",id:"VNbwjo6B2E"})})})]}),s&&d.jsx(d.Fragment,{children:d.jsx("div",{className:"mt-8 pt-8 border-t-[0.5px] border-border-300",children:d.jsxs("button",{onClick:async()=>{try{await chrome.runtime.sendMessage({type:"logout"}),await o(),window.location.reload()}catch(e){alert("Failed to logout. Please try again.")}},className:"w-full flex items-center gap-2 px-3 py-3 text-danger-000 hover:bg-danger-000/10 rounded-lg transition-all font-base",children:[d.jsx(_,{className:"w-4 h-4"}),d.jsx(t,{defaultMessage:"Log out",id:"PlBReUqqzW"})]})})})]}),d.jsxs("div",{children:["api"===y&&m&&d.jsx(R,{apiKey:f,setApiKey:b,onSave:async()=>{await h(x.ANTHROPIC_API_KEY,f),v(!0),setTimeout(()=>v(!1),2e3)},saved:j}),"model"===y&&m&&d.jsx(D,{systemPrompt:M,setSystemPrompt:S,debugMode:E,setDebugMode:P,onPromptSave:async()=>{await h(x.SYSTEM_PROMPT,M),v(!0),setTimeout(()=>v(!1),2e3)},onResetPrompt:()=>{S("")},saved:j,setSaved:v,allowEditSystemPrompt:u}),"permissions"===y&&d.jsx(T,{}),"prompts"===y&&d.jsx(k,{}),"testdata"===y&&m&&d.jsx(I,{})]})]}):d.jsx("div",{className:"flex flex-col items-center justify-center min-h-[400px]",children:d.jsx(w,{})})]}),d.jsx(F,{isOpen:A,returnTabId:G,onClose:()=>B(!1)})]})}b(),j(),i.createRoot(document.getElementById("root")).render(d.jsx(m.StrictMode,{children:d.jsx(l,{pageName:"Options",children:d.jsx(B,{})})}));
