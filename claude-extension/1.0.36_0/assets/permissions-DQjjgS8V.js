function e(e,t){for(var n=0;n<t.length;n++){const r=t[n];if("string"!=typeof r&&!Array.isArray(r))for(const t in r)if("default"!==t&&!(t in e)){const n=Object.getOwnPropertyDescriptor(r,t);n&&Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:()=>r[t]})}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function n(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if("function"==typeof t){var n=function e(){var n=!1;try{n=this instanceof e}catch{}return n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})}),n}var r,o,i={exports:{}},s={};function a(){return o||(o=1,i.exports=function(){if(r)return s;r=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(t,n,r){var o=null;if(void 0!==r&&(o=""+r),void 0!==n.key&&(o=""+n.key),"key"in n)for(var i in r={},n)"key"!==i&&(r[i]=n[i]);else r=n;return n=r.ref,{$$typeof:e,type:t,key:o,ref:void 0!==n?n:null,props:r}}return s.Fragment=t,s.jsx=n,s.jsxs=n,s}()),i.exports}var l,u,c=a(),d={exports:{}},_={};function f(){if(l)return _;l=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.for("react.activity"),g=Symbol.iterator;var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,v={};function m(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||h}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||h}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=m.prototype;var S=b.prototype=new y;S.constructor=b,p(S,m.prototype),S.isPureReactComponent=!0;var E=Array.isArray;function w(){}var k={H:null,A:null,T:null,S:null},O=Object.prototype.hasOwnProperty;function D(t,n,r){var o=r.ref;return{$$typeof:e,type:t,key:n,ref:void 0!==o?o:null,props:r}}function I(t){return"object"==typeof t&&null!==t&&t.$$typeof===e}var C=/\/+/g;function T(e,t){return"object"==typeof e&&null!==e&&null!=e.key?(n=""+e.key,r={"=":"=0",":":"=2"},"$"+n.replace(/[=:]/g,function(e){return r[e]})):t.toString(36);var n,r}function P(n,r,o,i,s){var a=typeof n;"undefined"!==a&&"boolean"!==a||(n=null);var l,u,c=!1;if(null===n)c=!0;else switch(a){case"bigint":case"string":case"number":c=!0;break;case"object":switch(n.$$typeof){case e:case t:c=!0;break;case d:return P((c=n._init)(n._payload),r,o,i,s)}}if(c)return s=s(n),c=""===i?"."+T(n,0):i,E(s)?(o="",null!=c&&(o=c.replace(C,"$&/")+"/"),P(s,r,o,"",function(e){return e})):null!=s&&(I(s)&&(l=s,u=o+(null==s.key||n&&n.key===s.key?"":(""+s.key).replace(C,"$&/")+"/")+c,s=D(l.type,u,l.props)),r.push(s)),1;c=0;var _,f=""===i?".":i+":";if(E(n))for(var h=0;h<n.length;h++)c+=P(i=n[h],r,o,a=f+T(i,h),s);else if("function"==typeof(h=null===(_=n)||"object"!=typeof _?null:"function"==typeof(_=g&&_[g]||_["@@iterator"])?_:null))for(n=h.call(n),h=0;!(i=n.next()).done;)c+=P(i=i.value,r,o,a=f+T(i,h++),s);else if("object"===a){if("function"==typeof n.then)return P(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"==typeof e.status?e.then(w,w):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(n),r,o,i,s);throw r=String(n),Error("Objects are not valid as a React child (found: "+("[object Object]"===r?"object with keys {"+Object.keys(n).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.")}return c}function A(e,t,n){if(null==e)return e;var r=[],o=0;return P(e,r,"","",function(e){return t.call(n,e,o++)}),r}function R(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var x="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e)},U={map:A,forEach:function(e,t,n){A(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return A(e,function(){t++}),t},toArray:function(e){return A(e,function(e){return e})||[]},only:function(e){if(!I(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};return _.Activity=f,_.Children=U,_.Component=m,_.Fragment=n,_.Profiler=o,_.PureComponent=b,_.StrictMode=r,_.Suspense=u,_.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,_.__COMPILER_RUNTIME={__proto__:null,c:function(e){return k.H.useMemoCache(e)}},_.cache=function(e){return function(){return e.apply(null,arguments)}},_.cacheSignal=function(){return null},_.cloneElement=function(e,t,n){if(null==e)throw Error("The argument must be a React element, but you passed "+e+".");var r=p({},e.props),o=e.key;if(null!=t)for(i in void 0!==t.key&&(o=""+t.key),t)!O.call(t,i)||"key"===i||"__self"===i||"__source"===i||"ref"===i&&void 0===t.ref||(r[i]=t[i]);var i=arguments.length-2;if(1===i)r.children=n;else if(1<i){for(var s=Array(i),a=0;a<i;a++)s[a]=arguments[a+2];r.children=s}return D(e.type,o,r)},_.createContext=function(e){return(e={$$typeof:s,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:i,_context:e},e},_.createElement=function(e,t,n){var r,o={},i=null;if(null!=t)for(r in void 0!==t.key&&(i=""+t.key),t)O.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(o[r]=t[r]);var s=arguments.length-2;if(1===s)o.children=n;else if(1<s){for(var a=Array(s),l=0;l<s;l++)a[l]=arguments[l+2];o.children=a}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===o[r]&&(o[r]=s[r]);return D(e,i,o)},_.createRef=function(){return{current:null}},_.forwardRef=function(e){return{$$typeof:a,render:e}},_.isValidElement=I,_.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:R}},_.memo=function(e,t){return{$$typeof:c,type:e,compare:void 0===t?null:t}},_.startTransition=function(e){var t=k.T,n={};k.T=n;try{var r=e(),o=k.S;null!==o&&o(n,r),"object"==typeof r&&null!==r&&"function"==typeof r.then&&r.then(w,x)}catch(i){x(i)}finally{null!==t&&null!==n.types&&(t.types=n.types),k.T=t}},_.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},_.use=function(e){return k.H.use(e)},_.useActionState=function(e,t,n){return k.H.useActionState(e,t,n)},_.useCallback=function(e,t){return k.H.useCallback(e,t)},_.useContext=function(e){return k.H.useContext(e)},_.useDebugValue=function(){},_.useDeferredValue=function(e,t){return k.H.useDeferredValue(e,t)},_.useEffect=function(e,t){return k.H.useEffect(e,t)},_.useEffectEvent=function(e){return k.H.useEffectEvent(e)},_.useId=function(){return k.H.useId()},_.useImperativeHandle=function(e,t,n){return k.H.useImperativeHandle(e,t,n)},_.useInsertionEffect=function(e,t){return k.H.useInsertionEffect(e,t)},_.useLayoutEffect=function(e,t){return k.H.useLayoutEffect(e,t)},_.useMemo=function(e,t){return k.H.useMemo(e,t)},_.useOptimistic=function(e,t){return k.H.useOptimistic(e,t)},_.useReducer=function(e,t,n){return k.H.useReducer(e,t,n)},_.useRef=function(e){return k.H.useRef(e)},_.useState=function(e){return k.H.useState(e)},_.useSyncExternalStore=function(e,t,n){return k.H.useSyncExternalStore(e,t,n)},_.useTransition=function(){return k.H.useTransition()},_.version="19.2.1",_}function g(){return u||(u=1,d.exports=f()),d.exports}var h=g();const p=t(h),v=e({__proto__:null,default:p},[h]);var m=(e=>(e.ACCESS_TOKEN="accessToken",e.REFRESH_TOKEN="refreshToken",e.TOKEN_EXPIRY="tokenExpiry",e.OAUTH_STATE="oauthState",e.CODE_VERIFIER="codeVerifier",e.ANTHROPIC_API_KEY="anthropicApiKey",e.SELECTED_MODEL="selectedModel",e.SYSTEM_PROMPT="systemPrompt",e.DEBUG_MODE="debugMode",e.MODEL_SELECTOR_DEBUG="modelSelectorDebug",e.SHOW_TRACE_IDS="showTraceIds",e.SHOW_SYSTEM_REMINDERS="showSystemReminders",e.USE_SESSIONS_API="useSessionsAPI",e.SESSIONS_API_HOSTNAME="sessionsApiHostname",e.BROWSER_CONTROL_PERMISSION_ACCEPTED="browserControlPermissionAccepted",e.PERMISSION_STORAGE="permissionStorage",e.LAST_PERMISSION_MODE_PREFERENCE="lastPermissionModePreference",e.ANONYMOUS_ID="anonymousId",e.TEST_DATA_MESSAGES="test_data_messages",e.SCHEDULED_TASK_LOGS="scheduledTaskLogs",e.SCHEDULED_TASK_STATS="scheduledTaskStats",e.PENDING_SCHEDULED_TASK="pendingScheduledTask",e.TARGET_TAB_ID="targetTabId",e.UPDATE_AVAILABLE="updateAvailable",e.TIP_DISPLAY_COUNTS="tipDisplayCounts",e.NEW_TAB_NOTE="newTabNote",e.CUSTOM_APP_LINKS="customAppLinks",e.NOTIFICATIONS_ENABLED="notificationsEnabled",e.ANNOUNCEMENT_DISMISSED="announcementDismissed",e.MODEL_OVERRIDE_SEEN="modelOverrideSeen",e.SAVED_PROMPTS="savedPrompts",e.SAVED_PROMPT_CATEGORIES="savedPromptCategories",e.TAB_GROUPS="tabGroups",e.DISMISSED_TAB_GROUPS="dismissedTabGroups",e.MCP_TAB_GROUP_ID="mcpTabGroupId",e.WIDGET_ORDER="widgetOrder",e))(m||{});async function y(e,t){const n=await chrome.storage.local.get(e);return void 0!==n[e]?n[e]:t}async function b(e,t){await chrome.storage.local.set({[e]:t})}async function S(e){const t=Array.isArray(e)?e:[e];await chrome.storage.local.remove(t)}async function E(e){return await chrome.storage.local.get(e)}async function w(e){await chrome.storage.local.set(e)}const k=new Set(["anonymousId","updateAvailable"]);async function O(){const e=Object.values(m).filter(e=>!k.has(e));await S(e)}const D={},I=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),o=n?.nonce||n?.getAttribute("nonce");r=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in D)return;D[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,o&&r.setAttribute("nonce",o),document.head.appendChild(r),t?new Promise((t,n)=>{r.addEventListener("load",t),r.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function o(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&o(e.reason);return e().catch(o)})};var C=function(e,t){return(C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function T(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}C(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var P=function(){return P=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},P.apply(this,arguments)};function A(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function R(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})}function x(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(l){a=[6,l],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}function U(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}function j(e,t,n){t.split&&(t=t.split("."));for(var r,o,i=0,s=t.length,a=e;i<s&&"__proto__"!=(o=""+t[i++])&&"constructor"!==o&&"prototype"!==o;)a=a[o]=i===s?n:typeof(r=a[o])==typeof t?r:0*t[i]!=0||~(""+t[i]).indexOf(".")?{}:[]}for(var L,M=256,N=[];M--;)N[M]=(M+256).toString(16).substring(1);function F(){var e,t=0,n="";if(!L||M+16>256){for(L=Array(t=256);t--;)L[t]=256*Math.random()|0;t=M=0}for(;t<16;t++)e=L[M+t],n+=6==t?N[15&e|64]:8==t?N[63&e|128]:N[e],1&t&&t>1&&t<11&&(n+="-");return M++,n}class K{static async getAllPrompts(){return await y(m.SAVED_PROMPTS)||[]}static async getPromptById(e){return(await this.getAllPrompts()).find(t=>t.id===e)}static async getPromptByCommand(e){return(await this.getAllPrompts()).find(t=>t.command===e)}static async savePrompt(e){const t=await this.getAllPrompts();if(e.command){if(t.find(t=>t.command===e.command))throw new Error(`/${e.command} is already in use`)}const n={...e,id:`prompt_${Date.now()}`,createdAt:e.createdAt||Date.now(),usageCount:e.usageCount||0};return t.push(n),await b(m.SAVED_PROMPTS,t),n.repeatType&&"none"!==n.repeatType&&await this.updateAlarmForPrompt(n),n}static async updatePrompt(e,t){const n=await this.getAllPrompts(),r=n.findIndex(t=>t.id===e);if(-1===r)return;if(t.command&&t.command!==n[r].command){if(n.find(e=>e.command===t.command))throw new Error(`/${t.command} is already in use`)}const o=n[r];n[r]={...n[r],...t},await b(m.SAVED_PROMPTS,n);const i=n[r];return o.repeatType===i.repeatType&&o.specificTime===i.specificTime&&o.specificDate===i.specificDate&&o.dayOfWeek===i.dayOfWeek&&o.dayOfMonth===i.dayOfMonth&&o.monthAndDay===i.monthAndDay||await this.updateAlarmForPrompt(i),n[r]}static async deletePrompt(e){const t=await this.getAllPrompts(),n=t.find(t=>t.id===e),r=t.filter(t=>t.id!==e);return r.length!==t.length&&(n?.repeatType&&"none"!==n.repeatType&&await chrome.alarms.clear(e),await b(m.SAVED_PROMPTS,r),!0)}static async recordPromptUsage(e){const t=await this.getAllPrompts(),n=t.find(t=>t.id===e);n&&(n.lastUsedAt=Date.now(),n.usageCount=(n.usageCount||0)+1,await b(m.SAVED_PROMPTS,t))}static async searchPrompts(e){const t=await this.getAllPrompts(),n=e.toLowerCase();return t.filter(e=>e.prompt.toLowerCase().includes(n)||e.command&&e.command.toLowerCase().includes(n))}static async exportPrompts(e){const t=await this.getAllPrompts(),n=e?t.filter(t=>e.includes(t.id)):t;return JSON.stringify(n,null,2)}static async importPrompts(e,t=!1){const n=JSON.parse(e),r=t?[]:await this.getAllPrompts(),o=n.map(e=>({...e,id:`prompt_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,createdAt:Date.now(),usageCount:0,lastUsedAt:void 0})),i=[...r,...o].filter(e=>e.command).map(e=>e.command),s=new Set(i);if(i.length!==s.size)throw new Error("Import contains duplicate command shortcuts");const a=[...r,...o];return await b(m.SAVED_PROMPTS,a),o.length}static async updateAlarmForPrompt(e){const t=e.id;if(await chrome.alarms.clear(t),!e.repeatType||"none"===e.repeatType||!e.specificTime)return;const n=new Date,[r,o]=e.specificTime.split(":").map(Number);switch(e.repeatType){case"once":{if(!e.specificDate)return;const[i,s,a]=e.specificDate.split("-").map(Number),l=new Date(i,s-1,a,r,o,0,0);l>n&&await chrome.alarms.create(t,{when:l.getTime()});break}case"daily":{const e=new Date;e.setHours(r,o,0,0),e<=n&&e.setDate(e.getDate()+1),await chrome.alarms.create(t,{when:e.getTime(),periodInMinutes:1440});break}case"weekly":{if(void 0===e.dayOfWeek)return;let i=(e.dayOfWeek-n.getDay()+7)%7;if(0===i){const e=new Date;e.setHours(r,o,0,0),e<=n&&(i=7)}const s=new Date;s.setDate(n.getDate()+i),s.setHours(r,o,0,0),await chrome.alarms.create(t,{when:s.getTime(),periodInMinutes:10080});break}case"monthly":{if(!e.dayOfMonth)return;const i=new Date;i.setDate(e.dayOfMonth),i.setHours(r,o,0,0),i<=n&&i.setMonth(i.getMonth()+1),await chrome.alarms.create(t,{when:i.getTime()});break}case"annually":{if(!e.monthAndDay)return;const[i,s]=e.monthAndDay.split("-").map(Number),a=new Date;a.setMonth(i-1),a.setDate(s),a.setHours(r,o,0,0),a<=n&&a.setFullYear(a.getFullYear()+1),await chrome.alarms.create(t,{when:a.getTime()});break}}}static async updateNextRunTimes(){const e=await this.getAllPrompts(),t=await chrome.alarms.getAll();let n=!1;for(const r of e)if(r.repeatType&&"none"!==r.repeatType){const e=t.find(e=>e.name===r.id),o=e?.scheduledTime;r.nextRun!==o&&(r.nextRun=o,n=!0)}else r.nextRun&&(r.nextRun=void 0,n=!0);n&&await b(m.SAVED_PROMPTS,e)}}const $=Object.freeze(Object.defineProperty({__proto__:null,SavedPromptsService:K},Symbol.toStringTag,{value:"Module"}));var z=(e=>(e.NAVIGATE="navigate",e.READ_PAGE_CONTENT="read_page_content",e.READ_CONSOLE_MESSAGES="read_console_messages",e.READ_NETWORK_REQUESTS="read_network_requests",e.CLICK="click",e.TYPE="type",e.UPLOAD_IMAGE="upload_image",e.DOMAIN_TRANSITION="domain_transition",e.PLAN_APPROVAL="plan_approval",e.EXECUTE_JAVASCRIPT="execute_javascript",e.REMOTE_MCP="remote_mcp",e))(z||{});const B={production:{STATSIG_CLIENT_API_KEY:"client-CyitfCoKlr6QZ2BXVfDZ3aDIE2fvWh4DTd4CIegPYQ8",SEGMENT_WRITE_KEY:"H7hVDRIBUrlBySLqJ15oAivgqhomdAKT"},development:{STATSIG_CLIENT_API_KEY:"client-FFBic9L5QkZYsnRDrIAvTimKS998hznw31H6KPBciH8",SEGMENT_WRITE_KEY:"hNex10EGp3coubOXQI1BIElYaZcA1o0u"}},V="fcoeoabgfenejglbffodgkkbkcdhcgfn",G={AUTHORIZE_URL:"https://claude.ai/oauth/authorize",TOKEN_URL:"https://console.anthropic.com/v1/oauth/token",SCOPES_STR:"user:profile user:inference user:chat",CLIENT_ID:"54511e87-7abf-4923-9d84-d6f24532e871",REDIRECT_URI:`chrome-extension://${"dihbgbndebgnbjfmelmegjepbnkhlgni"}/oauth_callback.html`},q={development:G,production:{...G,CLIENT_ID:"dae2cad8-15c5-43d2-9046-fcaecc135fa4",REDIRECT_URI:`chrome-extension://${V}/oauth_callback.html`}},H=()=>{const e="production",t=B[e],n=q[e];return{environment:e,apiBaseUrl:"https://api.anthropic.com",wsApiBaseUrl:"wss://api.anthropic.com",statsigClientApiKey:t.STATSIG_CLIENT_API_KEY,segmentWriteKey:t.SEGMENT_WRITE_KEY,oauth:n}};var W,J,Y={},Q={},X={},Z={};function ee(){return W||(W=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Log=e.LogLevel=void 0;e.LogLevel={None:0,Error:1,Warn:2,Info:3,Debug:4};class t{static info(...n){t.level>=e.LogLevel.Info&&console.info("  INFO ",...function(e){return e.unshift("[Statsig]"),e}(n))}static debug(...n){t.level,e.LogLevel.Debug}static warn(...n){t.level,e.LogLevel.Warn}static error(...n){t.level,e.LogLevel.Error}}e.Log=t,t.level=e.LogLevel.Warn}(Z)),Z}function te(){return J||(J=1,function(e){var t,n,r;Object.defineProperty(e,"__esModule",{value:!0}),e._getInstance=e._getStatsigGlobalFlag=e._getStatsigGlobal=void 0;const o=ee();e._getStatsigGlobal=()=>{try{return"undefined"!=typeof __STATSIG__?__STATSIG__:u}catch(e){return u}};e._getStatsigGlobalFlag=t=>(0,e._getStatsigGlobal)()[t];e._getInstance=t=>{const n=(0,e._getStatsigGlobal)();return t?n.instances&&n.instances[t]:(n.instances&&Object.keys(n.instances).length>1&&o.Log.warn("Call made to Statsig global instance without an SDK key but there is more than one client instance. If you are using mulitple clients, please specify the SDK key."),n.firstInstance)};const i="__STATSIG__",s="undefined"!=typeof window?window:{},a="undefined"!=typeof globalThis?globalThis:{},l="undefined"!=typeof globalThis?globalThis:{},u=null!==(r=null!==(n=null!==(t=s[i])&&void 0!==t?t:a[i])&&void 0!==n?n:l[i])&&void 0!==r?r:{instance:e._getInstance};s[i]=u,a[i]=u,l[i]=u}(X)),X}var ne,re={};function oe(){return ne||(ne=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Diagnostics=void 0;const t=new Map,n="start",r="end",o="statsig::diagnostics";function i(e,t,n,r){return Object.assign({key:n,action:t,step:r,timestamp:Date.now()},e)}function s(e,n){var r;const o=null!==(r=t.get(e))&&void 0!==r?r:[];o.push(n),t.set(e,o)}function a(e,t){if(t in e)return e[t]}e.Diagnostics={_getMarkers:e=>t.get(e),_markInitOverallStart:e=>{s(e,i({},n,"overall"))},_markInitOverallEnd:(e,t,n)=>{s(e,i({success:t,error:t?void 0:{name:"InitializeError",message:"Failed to initialize"},evaluationDetails:n},r,"overall"))},_markInitNetworkReqStart:(e,t)=>{s(e,i(t,n,"initialize","network_request"))},_markInitNetworkReqEnd:(e,t)=>{s(e,i(t,r,"initialize","network_request"))},_markInitProcessStart:e=>{s(e,i({},n,"initialize","process"))},_markInitProcessEnd:(e,t)=>{s(e,i(t,r,"initialize","process"))},_clearMarkers:e=>{t.delete(e)},_formatError(e){if(e&&"object"==typeof e)return{code:a(e,"code"),name:a(e,"name"),message:a(e,"message")}},_getDiagnosticsData(t,n,r,o){var i;return{success:!0===(null==t?void 0:t.ok),statusCode:null==t?void 0:t.status,sdkRegion:null===(i=null==t?void 0:t.headers)||void 0===i?void 0:i.get("x-statsig-region"),isDelta:!0===r.includes('"is_delta":true')||void 0,attempt:n,error:e.Diagnostics._formatError(o)}},_enqueueDiagnosticsEvent(t,n,r,i){const s=e.Diagnostics._getMarkers(r);if(null==s||s.length<=0)return-1;const a=s[s.length-1].timestamp-s[0].timestamp;e.Diagnostics._clearMarkers(r);const l=function(e,t){const n={eventName:o,user:e,value:null,metadata:t,time:Date.now()};return n}(t,{context:"initialize",markers:s.slice(),statsigOptions:i});return n.enqueue(l),a}}}(re)),re}var ie,se,ae,le={},ue={},ce={},de={};function _e(){if(ie)return de;return ie=1,Object.defineProperty(de,"__esModule",{value:!0}),de._isTypeMatch=de._typeOf=void 0,de._typeOf=function(e){return Array.isArray(e)?"array":typeof e},de._isTypeMatch=function(e,t){const n=e=>Array.isArray(e)?"array":null===e?"null":typeof e;return n(e)===n(t)},de}function fe(){return se||(se=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._getSortedObject=e._DJB2Object=e._DJB2=void 0;const t=_e();e._DJB2=e=>{let t=0;for(let n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return String(t>>>0)};e._DJB2Object=(t,n)=>(0,e._DJB2)(JSON.stringify((0,e._getSortedObject)(t,n)));e._getSortedObject=(n,r)=>{if(null==n)return null;const o=Object.keys(n).sort(),i={};return o.forEach(o=>{const s=n[o];0!==r&&"object"===(0,t._typeOf)(s)?i[o]=(0,e._getSortedObject)(s,null!=r?r-1:r):i[o]=s}),i}}(ce)),ce}function ge(){if(ae)return ue;ae=1,Object.defineProperty(ue,"__esModule",{value:!0}),ue._getStorageKey=ue._getUserStorageKey=void 0;const e=fe();function t(t,n,r){var o;if(r)return r(t,n);const i=n&&n.customIDs?n.customIDs:{},s=[`uid:${null!==(o=null==n?void 0:n.userID)&&void 0!==o?o:""}`,`cids:${Object.keys(i).sort((e,t)=>e.localeCompare(t)).map(e=>`${e}-${i[e]}`).join(",")}`,`k:${t}`];return(0,e._DJB2)(s.join("|"))}return ue._getUserStorageKey=t,ue._getStorageKey=function(n,r,o){return r?t(n,r,o):(0,e._DJB2)(`k:${n}`)},ue}var he,pe={};function ve(){return he||(he=1,e=pe,Object.defineProperty(e,"__esModule",{value:!0}),e.NetworkParam=e.NetworkDefault=e.Endpoint=void 0,e.Endpoint={_initialize:"initialize",_rgstr:"rgstr",_download_config_specs:"download_config_specs"},e.NetworkDefault={[e.Endpoint._rgstr]:"https://prodregistryv2.org/v1",[e.Endpoint._initialize]:"https://featureassets.org/v1",[e.Endpoint._download_config_specs]:"https://api.statsigcdn.com/v1"},e.NetworkParam={EventCount:"ec",SdkKey:"k",SdkType:"st",SdkVersion:"sv",Time:"t",SessionID:"sid",StatsigEncoded:"se",IsGzipped:"gz"}),pe;var e}var me,ye={};function be(){return me||(me=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._getUnloadEvent=e._getCurrentPageUrlSafe=e._addDocumentEventListenerSafe=e._addWindowEventListenerSafe=e._isServerEnv=e._getDocumentSafe=e._getWindowSafe=void 0;e._getWindowSafe=()=>"undefined"!=typeof window?window:null;e._getDocumentSafe=()=>{var t;const n=(0,e._getWindowSafe)();return null!==(t=null==n?void 0:n.document)&&void 0!==t?t:null};e._isServerEnv=()=>{if(null!==(0,e._getDocumentSafe)())return!1;const t="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node;return"string"==typeof EdgeRuntime||t};e._addWindowEventListenerSafe=(t,n)=>{const r=(0,e._getWindowSafe)();"function"==typeof(null==r?void 0:r.addEventListener)&&r.addEventListener(t,n)};e._addDocumentEventListenerSafe=(t,n)=>{const r=(0,e._getDocumentSafe)();"function"==typeof(null==r?void 0:r.addEventListener)&&r.addEventListener(t,n)};e._getCurrentPageUrlSafe=()=>{var t;try{return null===(t=(0,e._getWindowSafe)())||void 0===t?void 0:t.location.href.split(/[?#]/)[0]}catch(n){return}};e._getUnloadEvent=()=>{const t=(0,e._getWindowSafe)();if(!t)return"beforeunload";return"onpagehide"in t?"pagehide":"beforeunload"}}(ye)),ye}var Se,Ee={};function we(){if(Se)return Ee;Se=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee._createLayerParameterExposure=Ee._createConfigExposure=Ee._mapExposures=Ee._createGateExposure=Ee._isExposureEvent=void 0;const e="statsig::config_exposure",t="statsig::gate_exposure",n="statsig::layer_exposure",r=(e,t,n,r,o)=>(n.bootstrapMetadata&&(r.bootstrapMetadata=n.bootstrapMetadata),{eventName:e,user:t,value:null,metadata:i(n,r),secondaryExposures:o,time:Date.now()});Ee._isExposureEvent=({eventName:r})=>r===t||r===e||r===n;function o(e,t){return e.map(e=>"string"==typeof e?(null!=t?t:{})[e]:e).filter(e=>null!=e)}Ee._createGateExposure=(e,n,i)=>{var s,a,l;const u={gate:n.name,gateValue:String(n.value),ruleID:n.ruleID};return null!=(null===(s=n.__evaluation)||void 0===s?void 0:s.version)&&(u.configVersion=n.__evaluation.version),r(t,e,n.details,u,o(null!==(l=null===(a=n.__evaluation)||void 0===a?void 0:a.secondary_exposures)&&void 0!==l?l:[],i))},Ee._mapExposures=o;Ee._createConfigExposure=(t,n,i)=>{var s,a,l,u;const c={config:n.name,ruleID:n.ruleID};return null!=(null===(s=n.__evaluation)||void 0===s?void 0:s.version)&&(c.configVersion=n.__evaluation.version),null!=(null===(a=n.__evaluation)||void 0===a?void 0:a.passed)&&(c.rulePassed=String(n.__evaluation.passed)),r(e,t,n.details,c,o(null!==(u=null===(l=n.__evaluation)||void 0===l?void 0:l.secondary_exposures)&&void 0!==u?u:[],i))};Ee._createLayerParameterExposure=(e,t,i,s)=>{var a,l,u,c,d,_,f;const g=t.__evaluation,h=!0===(null===(a=null==g?void 0:g.explicit_parameters)||void 0===a?void 0:a.includes(i));let p="",v=null!==(l=null==g?void 0:g.undelegated_secondary_exposures)&&void 0!==l?l:[];h&&(p=null!==(u=g.allocated_experiment_name)&&void 0!==u?u:"",v=null!==(c=g.secondary_exposures)&&void 0!==c?c:[]);const m=null===(d=t.__evaluation)||void 0===d?void 0:d.parameter_rule_ids,y={config:t.name,parameterName:i,ruleID:null!==(_=null==m?void 0:m[i])&&void 0!==_?_:t.ruleID,allocatedExperiment:p,isExplicitParameter:String(h)};return null!=(null===(f=t.__evaluation)||void 0===f?void 0:f.version)&&(y.configVersion=t.__evaluation.version),r(n,e,t.details,y,o(v,s))};const i=(e,t)=>(t.reason=e.reason,e.lcut&&(t.lcut=String(e.lcut)),e.receivedAt&&(t.receivedAt=String(e.receivedAt)),t);return Ee}var ke,Oe={};function De(){return ke||(ke=1,Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.LoggingEnabledOption=Oe.LogEventCompressionMode=void 0,Oe.LogEventCompressionMode={Disabled:"d",Enabled:"e",Forced:"f"},Oe.LoggingEnabledOption={disabled:"disabled",browserOnly:"browser-only",always:"always"}),Oe}var Ie,Ce={};function Te(){return Ie||(Ie=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._setObjectInStorage=e._getObjectFromStorage=e.Storage=void 0;const t=ee(),n=be(),r={},o={isReady:()=>!0,isReadyResolver:()=>null,getProviderName:()=>"InMemory",getItem:e=>r[e]?r[e]:null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]},getAllKeys:()=>Object.keys(r)};let i=null;try{const e=(0,n._getWindowSafe)();e&&e.localStorage&&"function"==typeof e.localStorage.getItem&&(i={isReady:()=>!0,isReadyResolver:()=>null,getProviderName:()=>"LocalStorage",getItem:t=>e.localStorage.getItem(t),setItem:(t,n)=>e.localStorage.setItem(t,n),removeItem:t=>e.localStorage.removeItem(t),getAllKeys:()=>Object.keys(e.localStorage)})}catch(u){t.Log.warn("Failed to setup localStorageProvider.")}let s=null!=i?i:o,a=s;function l(t){try{return t()}catch(u){if(u instanceof Error&&"SecurityError"===u.name)return e.Storage._setProvider(o),null;throw u}}e.Storage={isReady:()=>a.isReady(),isReadyResolver:()=>a.isReadyResolver(),getProviderName:()=>a.getProviderName(),getItem:e=>l(()=>a.getItem(e)),setItem:(e,t)=>l(()=>a.setItem(e,t)),removeItem:e=>a.removeItem(e),getAllKeys:()=>a.getAllKeys(),_setProvider:e=>{s=e,a=e},_setDisabled:e=>{a=e?o:s}},e._getObjectFromStorage=function(t){const n=e.Storage.getItem(t);return JSON.parse(null!=n?n:"null")},e._setObjectInStorage=function(t,n){e.Storage.setItem(t,JSON.stringify(n))}}(Ce)),Ce}var Pe,Ae={};function Re(){if(Pe)return Ae;Pe=1,Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.UrlConfiguration=void 0;const e=fe(),t=ve(),n={[t.Endpoint._initialize]:"i",[t.Endpoint._rgstr]:"e",[t.Endpoint._download_config_specs]:"d"};return Ae.UrlConfiguration=class{constructor(e,r,o,i){this.customUrl=null,this.fallbackUrls=null,this.endpoint=e,this.endpointDnsKey=n[e],r&&(this.customUrl=r),!r&&o&&(this.customUrl=o.endsWith("/")?`${o}${e}`:`${o}/${e}`),i&&(this.fallbackUrls=i);const s=t.NetworkDefault[e];this.defaultUrl=`${s}/${e}`}getUrl(){var e;return null!==(e=this.customUrl)&&void 0!==e?e:this.defaultUrl}getChecksum(){var t;const n=(null!==(t=this.fallbackUrls)&&void 0!==t?t:[]).sort().join(",");return(0,e._DJB2)(this.customUrl+n)}},Ae}var xe,Ue,je={};function Le(){return xe||(xe=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._notifyVisibilityChanged=e._subscribeToVisiblityChanged=e._isUnloading=e._isCurrentlyVisible=void 0;const t=be(),n="foreground",r="background",o=[];let i=n,s=!1;e._isCurrentlyVisible=()=>i===n;e._isUnloading=()=>s;e._subscribeToVisiblityChanged=e=>{o.unshift(e)};e._notifyVisibilityChanged=e=>{e!==i&&(i=e,o.forEach(t=>t(e)))},(0,t._addWindowEventListenerSafe)("focus",()=>{s=!1,(0,e._notifyVisibilityChanged)(n)}),(0,t._addWindowEventListenerSafe)("blur",()=>(0,e._notifyVisibilityChanged)(r)),(0,t._addDocumentEventListenerSafe)("visibilitychange",()=>{(0,e._notifyVisibilityChanged)("visible"===document.visibilityState?n:r)}),(0,t._addWindowEventListenerSafe)((0,t._getUnloadEvent)(),()=>{s=!0,(0,e._notifyVisibilityChanged)(r)})}(je)),je}function Me(){if(Ue)return le;Ue=1;var e=le&&le.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(le,"__esModule",{value:!0}),le.EventLogger=void 0;const t=ge(),n=fe(),r=ee(),o=ve(),i=be(),s=we(),a=De(),l=Te(),u=Re(),c=Le(),d={},_="startup",f="gained_focus";return le.EventLogger=class g{static _safeFlushAndForget(e){var t;null===(t=d[e])||void 0===t||t.flush().catch(()=>{})}static _safeRetryFailedLogs(e){var t;null===(t=d[e])||void 0===t||t._retryFailedLogs(f)}constructor(e,t,n,i){var s,l;this._sdkKey=e,this._emitter=t,this._network=n,this._options=i,this._queue=[],this._lastExposureTimeMap={},this._nonExposedChecks={},this._hasRunQuickFlush=!1,this._creationTime=Date.now(),this._loggingEnabled=null!==(s=null==i?void 0:i.loggingEnabled)&&void 0!==s?s:!0===(null==i?void 0:i.disableLogging)?a.LoggingEnabledOption.disabled:a.LoggingEnabledOption.browserOnly,(null==i?void 0:i.loggingEnabled)&&void 0!==i.disableLogging&&r.Log.warn("Detected both loggingEnabled and disableLogging options. loggingEnabled takes precedence - please remove disableLogging."),this._maxQueueSize=null!==(l=null==i?void 0:i.loggingBufferMaxSize)&&void 0!==l?l:100;const c=null==i?void 0:i.networkConfig;this._logEventUrlConfig=new u.UrlConfiguration(o.Endpoint._rgstr,null==c?void 0:c.logEventUrl,null==c?void 0:c.api,null==c?void 0:c.logEventFallbackUrls)}setLogEventCompressionMode(e){this._network.setLogEventCompressionMode(e)}setLoggingEnabled(e){if("disabled"===this._loggingEnabled&&"disabled"!==e){const e=this._getStorageKey(),t=(0,l._getObjectFromStorage)(e);t&&this._queue.push(...t),l.Storage.removeItem(e)}this._loggingEnabled=e}enqueue(e){this._shouldLogEvent(e)&&(this._normalizeAndAppendEvent(e),this._quickFlushIfNeeded(),this._queue.length>this._maxQueueSize&&g._safeFlushAndForget(this._sdkKey))}incrementNonExposureCount(e){var t;const n=null!==(t=this._nonExposedChecks[e])&&void 0!==t?t:0;this._nonExposedChecks[e]=n+1}reset(){this.flush().catch(()=>{}),this._lastExposureTimeMap={}}start(){var e;const t=(0,i._isServerEnv)();t&&"always"!==(null===(e=this._options)||void 0===e?void 0:e.loggingEnabled)||(d[this._sdkKey]=this,t||(0,c._subscribeToVisiblityChanged)(e=>{"background"===e?g._safeFlushAndForget(this._sdkKey):"foreground"===e&&g._safeRetryFailedLogs(this._sdkKey)}),this._retryFailedLogs(_),this._startBackgroundFlushInterval())}stop(){return e(this,void 0,void 0,function*(){this._flushIntervalId&&(clearInterval(this._flushIntervalId),this._flushIntervalId=null),delete d[this._sdkKey],yield this.flush()})}flush(){return e(this,void 0,void 0,function*(){if(this._appendAndResetNonExposedChecks(),0===this._queue.length)return;const e=this._queue;this._queue=[],yield this._sendEvents(e)})}_quickFlushIfNeeded(){this._hasRunQuickFlush||(this._hasRunQuickFlush=!0,Date.now()-this._creationTime>200||setTimeout(()=>g._safeFlushAndForget(this._sdkKey),200))}_shouldLogEvent(e){var n;if("always"!==(null===(n=this._options)||void 0===n?void 0:n.loggingEnabled)&&(0,i._isServerEnv)())return!1;if(!(0,s._isExposureEvent)(e))return!0;const r=e.user?e.user:{statsigEnvironment:void 0},o=(0,t._getUserStorageKey)(this._sdkKey,r),a=e.metadata?e.metadata:{},l=[e.eventName,o,a.gate,a.config,a.ruleID,a.allocatedExperiment,a.parameterName,String(a.isExplicitParameter),a.reason].join("|"),u=this._lastExposureTimeMap[l],c=Date.now();return!(u&&c-u<6e5)&&(Object.keys(this._lastExposureTimeMap).length>1e3&&(this._lastExposureTimeMap={}),this._lastExposureTimeMap[l]=c,!0)}_sendEvents(t){return e(this,void 0,void 0,function*(){var e,n;if("disabled"===this._loggingEnabled)return this._saveFailedLogsToStorage(t),!1;try{const o=(0,c._isUnloading)()&&this._network.isBeaconSupported()&&null==(null===(n=null===(e=this._options)||void 0===e?void 0:e.networkConfig)||void 0===n?void 0:n.networkOverrideFunc);this._emitter({name:"pre_logs_flushed",events:t});return(o?this._sendEventsViaBeacon(t):yield this._sendEventsViaPost(t)).success?(this._emitter({name:"logs_flushed",events:t}),!0):(r.Log.warn("Failed to flush events."),this._saveFailedLogsToStorage(t),!1)}catch(o){return r.Log.warn("Failed to flush events."),!1}})}_sendEventsViaPost(t){return e(this,void 0,void 0,function*(){var e;const n=yield this._network.post(this._getRequestData(t)),r=null!==(e=null==n?void 0:n.code)&&void 0!==e?e:-1;return{success:r>=200&&r<300}})}_sendEventsViaBeacon(e){return{success:this._network.beacon(this._getRequestData(e))}}_getRequestData(e){return{sdkKey:this._sdkKey,data:{events:e},urlConfig:this._logEventUrlConfig,retries:3,isCompressable:!0,params:{[o.NetworkParam.EventCount]:String(e.length)},credentials:"same-origin"}}_saveFailedLogsToStorage(e){for(;e.length>500;)e.shift();const t=this._getStorageKey();try{const n=this._getFailedLogsFromStorage(t);(0,l._setObjectInStorage)(t,[...n,...e])}catch(n){r.Log.warn("Unable to save failed logs to storage")}}_getFailedLogsFromStorage(e){let t=[];try{const n=(0,l._getObjectFromStorage)(e);return Array.isArray(n)&&(t=n),t}catch(n){return[]}}_retryFailedLogs(t){const n=this._getStorageKey();(()=>e(this,void 0,void 0,function*(){l.Storage.isReady()||(yield l.Storage.isReadyResolver());const e=(0,l._getObjectFromStorage)(n);if(!e)return;t===_&&l.Storage.removeItem(n);(yield this._sendEvents(e))&&t===f&&l.Storage.removeItem(n)}))().catch(()=>{r.Log.warn("Failed to flush stored logs")})}_getStorageKey(){return`statsig.failed_logs.${(0,n._DJB2)(this._sdkKey)}`}_normalizeAndAppendEvent(e){e.user&&(e.user=Object.assign({},e.user),delete e.user.privateAttributes);const t={},n=this._getCurrentPageUrl();n&&(t.statsigMetadata={currentPage:n});const o=Object.assign(Object.assign({},e),t);r.Log.debug("Enqueued Event:",o),this._queue.push(o)}_appendAndResetNonExposedChecks(){0!==Object.keys(this._nonExposedChecks).length&&(this._normalizeAndAppendEvent({eventName:"statsig::non_exposed_checks",user:null,time:Date.now(),metadata:{checks:Object.assign({},this._nonExposedChecks)}}),this._nonExposedChecks={})}_getCurrentPageUrl(){var e;if(!1!==(null===(e=this._options)||void 0===e?void 0:e.includeCurrentPageUrlWithEvents))return(0,i._getCurrentPageUrlSafe)()}_startBackgroundFlushInterval(){var e,t;const n=null!==(t=null===(e=this._options)||void 0===e?void 0:e.loggingIntervalMs)&&void 0!==t?t:1e4,r=setInterval(()=>{const e=d[this._sdkKey];e&&e._flushIntervalId===r?g._safeFlushAndForget(this._sdkKey):clearInterval(r)},n);this._flushIntervalId=r}},le}var Ne,Fe={};function Ke(){return Ne||(Ne=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.StatsigMetadataProvider=e.SDK_VERSION=void 0,e.SDK_VERSION="3.29.0";let t={sdkVersion:e.SDK_VERSION,sdkType:"js-mono"};e.StatsigMetadataProvider={get:()=>t,add:e=>{t=Object.assign(Object.assign({},t),e)}}}(Fe)),Fe}var $e,ze={};var Be,Ve,Ge={},qe={},He={};function We(){if(Be)return He;return Be=1,Object.defineProperty(He,"__esModule",{value:!0}),He.getUUID=void 0,He.getUUID=function(){if("undefined"!=typeof crypto&&"function"==typeof crypto.randomUUID)return crypto.randomUUID();let e=(new Date).getTime(),t="undefined"!=typeof performance&&performance.now&&1e3*performance.now()||0;return`xxxxxxxx-xxxx-4xxx-${"89ab"[Math.floor(4*Math.random())]}xxx-xxxxxxxxxxxx`.replace(/[xy]/g,n=>{let r=16*Math.random();return e>0?(r=(e+r)%16|0,e=Math.floor(e/16)):(r=(t+r)%16|0,t=Math.floor(t/16)),("x"===n?r:7&r|8).toString(16)})},He}function Je(){if(Ve)return qe;Ve=1,Object.defineProperty(qe,"__esModule",{value:!0}),qe.getCookieName=qe.StableID=void 0;const e=ge(),t=ee(),n=be(),r=Te(),o=We(),i={},s={},a={};function l(t){return`statsig.stable_id.${(0,e._getStorageKey)(t)}`}function u(e,n){const o=l(n);try{(0,r._setObjectInStorage)(o,e)}catch(i){t.Log.warn("Failed to save StableID to storage")}}function c(e,t){if(!s[t]||null==(0,n._getDocumentSafe)())return;const r=new Date;r.setFullYear(r.getFullYear()+1),document.cookie=`${d(t)}=${encodeURIComponent(e)}; expires=${r.toUTCString()}; path=/`}function d(t){return`statsig.stable_id.${(0,e._getStorageKey)(t)}`}return qe.StableID={cookiesEnabled:!1,randomID:Math.random().toString(36),get:e=>{if(a[e])return null;if(null!=i[e])return i[e];let t=null;return t=function(e){if(!s[e]||null==(0,n._getDocumentSafe)())return null;const t=document.cookie.split(";");for(const n of t){const[t,r]=n.trim().split("=");if(t===d(e))return decodeURIComponent(r)}return null}(e),null!=t?(i[e]=t,u(t,e),t):(t=function(e){const t=l(e);return(0,r._getObjectFromStorage)(t)}(e),null==t&&(t=(0,o.getUUID)()),u(t,e),c(t,e),i[e]=t,t)},setOverride:(e,t)=>{i[t]=e,u(e,t),c(e,t)},_setCookiesEnabled:(e,t)=>{s[e]=t},_setDisabled:(e,t)=>{a[e]=t}},qe.getCookieName=d,qe}var Ye,Qe={};function Xe(){if(Ye)return Qe;Ye=1,Object.defineProperty(Qe,"__esModule",{value:!0}),Qe._getFullUserHash=Qe._normalizeUser=void 0;const e=fe(),t=ee();return Qe._normalizeUser=function(e,n,r){try{const t=JSON.parse(JSON.stringify(e));return null!=n&&null!=n.environment?t.statsigEnvironment=n.environment:null!=r&&(t.statsigEnvironment={tier:r}),t}catch(o){return t.Log.error("Failed to JSON.stringify user"),{statsigEnvironment:void 0}}},Qe._getFullUserHash=function(t){return t?(0,e._DJB2Object)(t):null},Qe}var Ze,et,tt={};function nt(){if(Ze)return tt;Ze=1,Object.defineProperty(tt,"__esModule",{value:!0}),tt._typedJsonParse=void 0;const e=ee();return tt._typedJsonParse=function(t,n,r){try{const e=JSON.parse(t);if(e&&"object"==typeof e&&n in e)return e}catch(o){}return e.Log.error(`Failed to parse ${r}`),null},tt}function rt(){if(et)return Ge;et=1;var e=Ge&&Ge.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(Ge,"__esModule",{value:!0}),Ge._makeDataAdapterResult=Ge.DataAdapterCore=void 0;const t=ee(),n=Je(),r=Xe(),o=Te(),i=nt();function s(e,t,n,o){return{source:e,data:t,receivedAt:Date.now(),stableID:n,fullUserHash:(0,r._getFullUserHash)(o)}}Ge.DataAdapterCore=class{constructor(e,t){this._adapterName=e,this._cacheSuffix=t,this._options=null,this._sdkKey=null,this._cacheLimit=10,this._lastModifiedStoreKey=`statsig.last_modified_time.${t}`,this._inMemoryCache=new a}attach(e,t,n){this._sdkKey=e,this._options=t}getDataSync(e){const t=e&&(0,r._normalizeUser)(e,this._options),n=this._getCacheKey(t),o=this._inMemoryCache.get(n,t);if(o&&this._getIsCacheValueValid(o))return o;const i=this._loadFromCache(n);return i&&this._getIsCacheValueValid(i)?(this._inMemoryCache.add(n,i,this._cacheLimit),this._inMemoryCache.get(n,t)):null}setData(e,t){const n=t&&(0,r._normalizeUser)(t,this._options),o=this._getCacheKey(n);this._inMemoryCache.add(o,s("Bootstrap",e,null,n),this._cacheLimit)}_getIsCacheValueValid(e){return null==e.stableID||e.stableID===n.StableID.get(this._getSdkKey())}_getDataAsyncImpl(n,r,i){return e(this,void 0,void 0,function*(){o.Storage.isReady()||(yield o.Storage.isReadyResolver());const e=null!=n?n:this.getDataSync(r),s=[this._fetchAndPrepFromNetwork(e,r,i)];return(null==i?void 0:i.timeoutMs)&&s.push(new Promise(e=>setTimeout(e,i.timeoutMs)).then(()=>(t.Log.debug("Fetching latest value timed out"),null))),yield Promise.race(s)})}_prefetchDataImpl(t,n){return e(this,void 0,void 0,function*(){const e=t&&(0,r._normalizeUser)(t,this._options),o=this._getCacheKey(e),i=yield this._getDataAsyncImpl(null,e,n);i&&this._inMemoryCache.add(o,Object.assign(Object.assign({},i),{source:"Prefetch"}),this._cacheLimit)})}_fetchAndPrepFromNetwork(r,o,a){return e(this,void 0,void 0,function*(){var e;const l=null!==(e=null==r?void 0:r.data)&&void 0!==e?e:null,u=null!=r&&this._isCachedResultValidFor204(r,o),c=yield this._fetchFromNetwork(l,o,a,u);if(!c)return t.Log.debug("No response returned for latest value"),null;const d=(0,i._typedJsonParse)(c,"has_updates","Response"),_=this._getSdkKey(),f=n.StableID.get(_);let g=null;if(!0===(null==d?void 0:d.has_updates))g=s("Network",c,f,o);else{if(!l||!1!==(null==d?void 0:d.has_updates))return null;g=s("NetworkNotModified",l,f,o)}const h=this._getCacheKey(o);return this._inMemoryCache.add(h,g,this._cacheLimit),this._writeToCache(h,g),g})}_getSdkKey(){return null!=this._sdkKey?this._sdkKey:(t.Log.error(`${this._adapterName} is not attached to a Client`),"")}_loadFromCache(e){var t;const n=null===(t=o.Storage.getItem)||void 0===t?void 0:t.call(o.Storage,e);if(null==n)return null;const r=(0,i._typedJsonParse)(n,"source","Cached Result");return r?Object.assign(Object.assign({},r),{source:"Cache"}):null}_writeToCache(e,t){const n=JSON.stringify(t);for(let i=0;i<8;i++)try{o.Storage.setItem(e,n);break}catch(r){if(!(r instanceof Error)||!r.toString().includes("QuotaExceededError")&&!r.toString().includes("QUOTA_EXCEEDED_ERR")||this._cacheLimit<=1)throw r;this._cacheLimit=Math.ceil(this._cacheLimit/2),this._runLocalStorageCacheEviction(e,this._cacheLimit-1)}this._runLocalStorageCacheEviction(e)}_runLocalStorageCacheEviction(e,t=this._cacheLimit){var n;const r=null!==(n=(0,o._getObjectFromStorage)(this._lastModifiedStoreKey))&&void 0!==n?n:{};r[e]=Date.now();const i=l(r,t);for(const s of i)delete r[s],o.Storage.removeItem(s);(0,o._setObjectInStorage)(this._lastModifiedStoreKey,r)}},Ge._makeDataAdapterResult=s;class a{constructor(){this._data={}}get(e,n){var r;const o=this._data[e],i=null==o?void 0:o.stableID,s=null===(r=null==n?void 0:n.customIDs)||void 0===r?void 0:r.stableID;return s&&i&&s!==i?(t.Log.warn("'StatsigUser.customIDs.stableID' mismatch"),null):o}add(e,t,n){const r=l(this._data,n-1);for(const o of r)delete this._data[o];this._data[e]=t}merge(e){this._data=Object.assign(Object.assign({},this._data),e)}}function l(e,t){const n=Object.keys(e);return n.length<=t?[]:0===t?n:n.sort((t,n)=>{const r=e[t],o=e[n];return"object"==typeof r&&"object"==typeof o?r.receivedAt-o.receivedAt:r-o}).slice(0,n.length-t)}return Ge}var ot,it={};var st,at,lt={},ut={};function ct(){if(st)return ut;st=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.SDKType=void 0;const e={};let t;return ut.SDKType={_get:n=>{var r;return(null!==(r=e[n])&&void 0!==r?r:"js-mono")+(null!=t?t:"")},_setClientType(t,n){e[t]=n},_setBindingType(e){t&&"-react"!==t||(t="-"+e)}},ut}function dt(){return at||(at=1,function(e){var t=lt&&lt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.ErrorBoundary=e.EXCEPTION_ENDPOINT=void 0;const n=ee(),r=ct(),o=Ke();e.EXCEPTION_ENDPOINT="https://statsigapi.net/v1/sdk_exception";const i="[Statsig] UnknownError";function s(e){return e instanceof Error?e:"string"==typeof e?new Error(e):new Error("An unknown error occurred.")}function a(e){if(!e)return{};const t={};return Object.keys(e).forEach(n=>{const r=n,o=e[r];switch(typeof o){case"number":case"bigint":case"boolean":t[String(r)]=o;break;case"string":o.length<50?t[String(r)]=o:t[String(r)]="set";break;case"object":"environment"===r?t.environment=o:"networkConfig"===r?t.networkConfig=o:t[String(r)]=null!=o?"set":"unset"}}),t}e.ErrorBoundary=class{constructor(e,t,n,r){this._sdkKey=e,this._options=t,this._emitter=n,this._lastSeenError=r,this._seen=new Set}wrap(e,t){try{const n=e;(function(e){const t=new Set;let n=Object.getPrototypeOf(e);for(;n&&n!==Object.prototype;)Object.getOwnPropertyNames(n).filter(e=>"function"==typeof(null==n?void 0:n[e])).forEach(e=>t.add(e)),n=Object.getPrototypeOf(n);return Array.from(t)})(n).forEach(r=>{const o=n[r];"$EB"in o||(n[r]=(...n)=>this._capture(t?`${t}:${r}`:r,()=>o.apply(e,n)),n[r].$EB=!0)})}catch(n){this._onError("eb:wrap",n)}}logError(e,t){this._onError(e,t)}getLastSeenErrorAndReset(){const e=this._lastSeenError;return this._lastSeenError=void 0,null!=e?e:null}attachErrorIfNoneExists(e){this._lastSeenError||(this._lastSeenError=s(e))}_capture(e,t){try{const n=t();return n&&n instanceof Promise?n.catch(t=>this._onError(e,t)):n}catch(n){return this._onError(e,n),null}}_onError(l,u){try{n.Log.warn(`Caught error in ${l}`,{error:u});(()=>t(this,void 0,void 0,function*(){var t,n,c,d,_,f,g;const h=u||Error(i),p=h instanceof Error,v=p?h.name:"No Name",m=s(h);if(this._lastSeenError=m,this._seen.has(v))return;if(this._seen.add(v),null===(n=null===(t=this._options)||void 0===t?void 0:t.networkConfig)||void 0===n?void 0:n.preventAllNetworkTraffic)return void(null===(c=this._emitter)||void 0===c||c.call(this,{name:"error",error:u,tag:l}));const y=r.SDKType._get(this._sdkKey),b=o.StatsigMetadataProvider.get(),S=p?h.stack:function(e){try{return JSON.stringify(e)}catch(t){return i}}(h),E=Object.assign({tag:l,exception:v,info:S,statsigOptions:a(this._options)},Object.assign(Object.assign({},b),{sdkType:y})),w=null!==(f=null===(_=null===(d=this._options)||void 0===d?void 0:d.networkConfig)||void 0===_?void 0:_.networkOverrideFunc)&&void 0!==f?f:fetch;yield w(e.EXCEPTION_ENDPOINT,{method:"POST",headers:{"STATSIG-API-KEY":this._sdkKey,"STATSIG-SDK-TYPE":String(y),"STATSIG-SDK-VERSION":String(b.sdkVersion),"Content-Type":"application/json"},body:JSON.stringify(E)}),null===(g=this._emitter)||void 0===g||g.call(this,{name:"error",error:u,tag:l})}))().then(()=>{}).catch(()=>{})}catch(c){}}}}(lt)),lt}var _t,ft={};var gt,ht={};var pt,vt={};var mt,yt={};function bt(){if(mt)return yt;mt=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.createMemoKey=yt.MemoPrefix=void 0,yt.MemoPrefix={_gate:"g",_dynamicConfig:"c",_experiment:"e",_configList:"cl",_layer:"l",_paramStore:"p"};const e=new Set([]),t=new Set(["userPersistedValues"]);return yt.createMemoKey=function(n,r,o){let i=`${n}|${r}`;if(!o)return i;for(const s of Object.keys(o)){if(t.has(s))return;e.has(s)?i+=`|${s}=true`:i+=`|${s}=${o[s]}`}return i},yt}var St,Et,wt={},kt={},Ot={};function Dt(){if(St)return Ot;St=1;var e=Ot&&Ot.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(Ot,"__esModule",{value:!0}),Ot._fetchTxtRecords=void 0;const t=new Uint8Array([0,0,1,0,0,1,0,0,0,0,0,0,13,102,101,97,116,117,114,101,97,115,115,101,116,115,3,111,114,103,0,0,16,0,1]),n=["i","e","d"];return Ot._fetchTxtRecords=function(r){return e(this,void 0,void 0,function*(){const e=yield r("https://cloudflare-dns.com/dns-query",{method:"POST",headers:{"Content-Type":"application/dns-message",Accept:"application/dns-message"},body:t});if(!e.ok){const e=new Error("Failed to fetch TXT records from DNS");throw e.name="DnsTxtFetchError",e}const o=yield e.arrayBuffer();return function(e){const t=e.findIndex((t,r)=>r<200&&"="===String.fromCharCode(t)&&n.includes(String.fromCharCode(e[r-1])));if(-1===t){const e=new Error("Failed to parse TXT records from DNS");throw e.name="DnsTxtParseError",e}let r="";for(let n=t-1;n<e.length;n++)r+=String.fromCharCode(e[n]);return r.split(",")}(new Uint8Array(o))})},Ot}function It(){if(Et)return kt;Et=1;var e=kt&&kt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(kt,"__esModule",{value:!0}),kt._isDomainFailure=kt.NetworkFallbackResolver=void 0;const t=Dt(),n=fe(),r=ee(),o=Te(),i=6048e5;function s(e,t){var n;const r=null!==(n=null==e?void 0:e.toLowerCase())&&void 0!==n?n:"";return t||r.includes("uncaught exception")||r.includes("failed to fetch")||r.includes("networkerror when attempting to fetch resource")}function a(e){return`statsig.network_fallback.${(0,n._DJB2)(e)}`}function l(e,t){const n=a(e);t&&0!==Object.keys(t).length?o.Storage.setItem(n,JSON.stringify(t)):o.Storage.removeItem(n)}return kt.NetworkFallbackResolver=class{constructor(e){var t;this._fallbackInfo=null,this._errorBoundary=null,this._dnsQueryCooldowns={},this._networkOverrideFunc=null===(t=e.networkConfig)||void 0===t?void 0:t.networkOverrideFunc}setErrorBoundary(e){this._errorBoundary=e}tryBumpExpiryTime(e,t){var n;const r=null===(n=this._fallbackInfo)||void 0===n?void 0:n[t.endpoint];r&&(r.expiryTime=Date.now()+i,l(e,Object.assign(Object.assign({},this._fallbackInfo),{[t.endpoint]:r})))}getActiveFallbackUrl(e,t){var n,i;if(null!=t.customUrl&&null!=t.fallbackUrls)return null;let s=this._fallbackInfo;null==s&&(s=null!==(n=function(e){const t=a(e),i=o.Storage.getItem(t);if(!i)return null;try{return JSON.parse(i)}catch(n){return r.Log.error("Failed to parse FallbackInfo"),null}}(e))&&void 0!==n?n:{},this._fallbackInfo=s);const u=s[t.endpoint];return!u||Date.now()>(null!==(i=u.expiryTime)&&void 0!==i?i:0)||t.getChecksum()!==u.urlConfigChecksum?(delete s[t.endpoint],this._fallbackInfo=s,l(e,this._fallbackInfo),null):u.url?u.url:null}tryFetchUpdatedFallbackInfo(t,n,r,o){return e(this,void 0,void 0,function*(){var e,i;try{if(!s(r,o))return!1;const i=null==n.customUrl&&null==n.fallbackUrls?yield this._tryFetchFallbackUrlsFromNetwork(n):n.fallbackUrls,a=this._pickNewFallbackUrl(null===(e=this._fallbackInfo)||void 0===e?void 0:e[n.endpoint],i);return!!a&&(this._updateFallbackInfoWithNewUrl(t,n,a),!0)}catch(a){return null===(i=this._errorBoundary)||void 0===i||i.logError("tryFetchUpdatedFallbackInfo",a),!1}})}_updateFallbackInfoWithNewUrl(e,t,n){var r,o,s;const a={urlConfigChecksum:t.getChecksum(),url:n,expiryTime:Date.now()+i,previous:[]},u=t.endpoint,c=null===(r=this._fallbackInfo)||void 0===r?void 0:r[u];c&&a.previous.push(...c.previous),a.previous.length>10&&(a.previous=[]);const d=null===(s=null===(o=this._fallbackInfo)||void 0===o?void 0:o[u])||void 0===s?void 0:s.url;null!=d&&a.previous.push(d),this._fallbackInfo=Object.assign(Object.assign({},this._fallbackInfo),{[u]:a}),l(e,this._fallbackInfo)}_tryFetchFallbackUrlsFromNetwork(n){return e(this,void 0,void 0,function*(){var e;const r=this._dnsQueryCooldowns[n.endpoint];if(r&&Date.now()<r)return null;this._dnsQueryCooldowns[n.endpoint]=Date.now()+144e5;const o=[],i=yield(0,t._fetchTxtRecords)(null!==(e=this._networkOverrideFunc)&&void 0!==e?e:fetch),s=function(e){try{return new URL(e).pathname}catch(t){return null}}(n.defaultUrl);for(const t of i){if(!t.startsWith(n.endpointDnsKey+"="))continue;const e=t.split("=");if(e.length>1){let t=e[1];t.endsWith("/")&&(t=t.slice(0,-1)),o.push(`https://${t}${s}`)}}return o})}_pickNewFallbackUrl(e,t){var n;if(null==t)return null;const r=new Set(null!==(n=null==e?void 0:e.previous)&&void 0!==n?n:[]),o=null==e?void 0:e.url;let i=null;for(const s of t){const e=s.endsWith("/")?s.slice(0,-1):s;if(!r.has(s)&&e!==o){i=e;break}}return i}},kt._isDomainFailure=s,kt}var Ct,Tt={};function Pt(){if(Ct)return Tt;Ct=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.SDKFlags=void 0;const e={};return Tt.SDKFlags={setFlags:(t,n)=>{e[t]=n},get:(t,n)=>{var r,o;return null!==(o=null===(r=e[t])||void 0===r?void 0:r[n])&&void 0!==o&&o}},Tt}var At,Rt={};function xt(){return At||(At=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.StatsigSession=e.SessionID=void 0;const t=te(),n=ge(),r=ee(),o=Te(),i=We(),s=18e5,a=144e5,l={};function u(e,n){return setTimeout(()=>{var n;const r=null===(n=(0,t._getStatsigGlobal)())||void 0===n?void 0:n.instance(e);r&&r.$emt({name:"session_expired"})},n)}function c(e){return`statsig.session_id.${(0,n._getStorageKey)(e)}`}e.SessionID={get:t=>e.StatsigSession.get(t).data.sessionID},e.StatsigSession={get:e=>{null==l[e]&&(l[e]=function(e){let t=function(e){const t=c(e);return(0,o._getObjectFromStorage)(t)}(e);const n=Date.now();t||(t={sessionID:(0,i.getUUID)(),startTime:n,lastUpdate:n});return{data:t,sdkKey:e}}(e));return function(e){const t=Date.now(),n=e.data,l=e.sdkKey;if(function({lastUpdate:e}){return Date.now()-e>s}(n)||function({startTime:e}){return Date.now()-e>a}(n)){n.sessionID=(0,i.getUUID)(),n.startTime=t;const e=null===__STATSIG__||void 0===__STATSIG__?void 0:__STATSIG__.instance(l);e&&e.$emt({name:"session_expired"})}n.lastUpdate=t,function(e,t){const n=c(t);try{(0,o._setObjectInStorage)(n,e)}catch(i){r.Log.warn("Failed to save SessionID")}}(n,e.sdkKey),clearTimeout(e.idleTimeoutID),clearTimeout(e.ageTimeoutID);const d=t-n.startTime;return e.idleTimeoutID=u(l,s),e.ageTimeoutID=u(l,a-d),e}(l[e])},overrideInitialSessionID:(e,t)=>{l[t]=function(e,t){const n=Date.now();return{data:{sessionID:e,startTime:n,lastUpdate:n},sdkKey:t}}(e,t)}}}(Rt)),Rt}var Ut,jt,Lt={};function Mt(){return Ut||(Ut=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.ErrorTag=void 0,Lt.ErrorTag={NetworkError:"NetworkError"}),Lt}function Nt(){if(jt)return wt;jt=1;var e=wt&&wt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(wt,"__esModule",{value:!0}),wt.NetworkCore=void 0,te();const t=te(),n=oe(),r=ee(),o=ve(),i=It(),s=Pt(),a=ct(),l=be(),u=xt(),c=Je(),d=Mt(),_=Ke(),f=De(),g=Le(),h=new Set([408,500,502,503,504,522,524,599]);wt.NetworkCore=class{constructor(e,t){this._emitter=t,this._errorBoundary=null,this._timeout=1e4,this._netConfig={},this._options={},this._leakyBucket={},this._lastUsedInitUrl=null,e&&(this._options=e),this._options.networkConfig&&(this._netConfig=this._options.networkConfig),this._netConfig.networkTimeoutMs&&(this._timeout=this._netConfig.networkTimeoutMs),this._fallbackResolver=new i.NetworkFallbackResolver(this._options),this.setLogEventCompressionMode(this._getLogEventCompressionMode(e))}setLogEventCompressionMode(e){this._options.logEventCompressionMode=e}setErrorBoundary(e){this._errorBoundary=e,this._errorBoundary.wrap(this),this._errorBoundary.wrap(this._fallbackResolver),this._fallbackResolver.setErrorBoundary(e)}isBeaconSupported(){return"undefined"!=typeof navigator&&"function"==typeof navigator.sendBeacon}getLastUsedInitUrlAndReset(){const e=this._lastUsedInitUrl;return this._lastUsedInitUrl=null,e}beacon(e){if(!p(e))return!1;const t=this._getInternalRequestArgs("POST",e),n=this._getPopulatedURL(t),r=navigator;return r.sendBeacon.bind(r)(n,t.body)}post(t){return e(this,void 0,void 0,function*(){const e=this._getInternalRequestArgs("POST",t);return this._tryEncodeBody(e),yield this._tryToCompressBody(e),this._sendRequest(e)})}get(e){const t=this._getInternalRequestArgs("GET",e);return this._sendRequest(t)}_sendRequest(t){return e(this,void 0,void 0,function*(){var i,s,a,l;if(!p(t))return null;if(this._netConfig.preventAllNetworkTraffic)return null;const{method:u,body:c,retries:_,attempt:f}=t,v=t.urlConfig.endpoint;if(this._isRateLimited(v))return r.Log.warn(`Request to ${v} was blocked because you are making requests too frequently.`),null;const y=null!=f?f:1;let b=!1;const S=this._getPopulatedURL(t);let E=null;const w=(0,g._isUnloading)();try{const e={method:u,body:c,headers:Object.assign({},t.headers),priority:t.priority,keepalive:w};!function(e,t){if(e.urlConfig.endpoint!==o.Endpoint._initialize)return;n.Diagnostics._markInitNetworkReqStart(e.sdkKey,{attempt:t})}(t,y);const r=this._leakyBucket[v];r&&(r.lastRequestTime=Date.now(),this._leakyBucket[v]=r);const s=null!==(i=this._netConfig.networkOverrideFunc)&&void 0!==i?i:fetch;let a;if(E=yield Promise.race([s(S,e).finally(()=>clearTimeout(a)),new Promise((e,t)=>{a=setTimeout(()=>{b=!0,t(new Error(`Timeout of ${this._timeout}ms expired.`))},this._timeout)})]),!E.ok){const e=yield E.text().catch(()=>"No Text"),t=new Error(`NetworkError: ${S} ${e}`);throw t.name="NetworkError",t}const l=yield E.text();return m(t,E,y,l),this._fallbackResolver.tryBumpExpiryTime(t.sdkKey,t.urlConfig),{body:l,code:E.status}}catch(O){const n=function(e){if("string"==typeof e)return e;if(e instanceof Error)return`${e.name}: ${e.message}`;return"Unknown Error"}(O),o=(k=b,(null!=n?n:"").includes("Timeout")||k);m(t,E,y,"",O);if((yield this._fallbackResolver.tryFetchUpdatedFallbackInfo(t.sdkKey,t.urlConfig,n,o))&&(t.fallbackUrl=this._fallbackResolver.getActiveFallbackUrl(t.sdkKey,t.urlConfig)),!_||y>_||!h.has(null!==(s=null==E?void 0:E.status)&&void 0!==s?s:500)){null===(a=this._emitter)||void 0===a||a.call(this,{name:"error",error:O,tag:d.ErrorTag.NetworkError,requestArgs:t});const e=`A networking error occurred during ${u} request to ${S}.`;return r.Log.error(e,n,O),null===(l=this._errorBoundary)||void 0===l||l.attachErrorIfNoneExists(e),null}return yield function(t){return e(this,void 0,void 0,function*(){yield new Promise(e=>setTimeout(e,Math.min(t*t*500,3e4)))})}(y),this._sendRequest(Object.assign(Object.assign({},t),{retries:_,attempt:y+1}))}var k})}_getLogEventCompressionMode(e){let t=null==e?void 0:e.logEventCompressionMode;return t||!0!==(null==e?void 0:e.disableCompression)||(t=f.LogEventCompressionMode.Disabled),t||(t=f.LogEventCompressionMode.Enabled),t}_isRateLimited(e){var t;const n=Date.now(),r=null!==(t=this._leakyBucket[e])&&void 0!==t?t:{count:0,lastRequestTime:n},o=n-r.lastRequestTime,i=Math.floor(.05*o);return r.count=Math.max(0,r.count-i),r.count>=50||(r.count+=1,r.lastRequestTime=n,this._leakyBucket[e]=r,!1)}_getPopulatedURL(e){var t;const n=null!==(t=e.fallbackUrl)&&void 0!==t?t:e.urlConfig.getUrl();e.urlConfig.endpoint!==o.Endpoint._initialize&&e.urlConfig.endpoint!==o.Endpoint._download_config_specs||(this._lastUsedInitUrl=n);const r=Object.assign({[o.NetworkParam.SdkKey]:e.sdkKey,[o.NetworkParam.SdkType]:a.SDKType._get(e.sdkKey),[o.NetworkParam.SdkVersion]:_.SDK_VERSION,[o.NetworkParam.Time]:String(Date.now()),[o.NetworkParam.SessionID]:u.SessionID.get(e.sdkKey)},e.params),i=Object.keys(r).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(r[e])}`).join("&");return`${n}${i?`?${i}`:""}`}_tryEncodeBody(e){var n;const i=(0,l._getWindowSafe)(),s=e.body;if(e.isStatsigEncodable&&!this._options.disableStatsigEncoding&&"string"==typeof s&&null==(0,t._getStatsigGlobalFlag)("no-encode")&&(null==i?void 0:i.btoa))try{e.body=i.btoa(s).split("").reverse().join(""),e.params=Object.assign(Object.assign({},null!==(n=e.params)&&void 0!==n?n:{}),{[o.NetworkParam.StatsigEncoded]:"1"})}catch(a){r.Log.warn(`Request encoding failed for ${e.urlConfig.getUrl()}`,a)}}_tryToCompressBody(n){return e(this,void 0,void 0,function*(){var e;const i=n.body;if("string"==typeof i&&function(e,n){if(!e.isCompressable)return!1;if(null!=(0,t._getStatsigGlobalFlag)("no-compress")||"undefined"==typeof CompressionStream||"undefined"==typeof TextEncoder)return!1;const r=null!=e.urlConfig.customUrl||null!=e.urlConfig.fallbackUrls,o=!0===s.SDKFlags.get(e.sdkKey,"enable_log_event_compression");switch(n.logEventCompressionMode){case f.LogEventCompressionMode.Disabled:return!1;case f.LogEventCompressionMode.Enabled:return!(r&&!o);case f.LogEventCompressionMode.Forced:return!0;default:return!1}}(n,this._options))try{const t=(new TextEncoder).encode(i),s=new CompressionStream("gzip"),a=s.writable.getWriter();a.write(t).catch(r.Log.error),a.close().catch(r.Log.error);const l=s.readable.getReader(),u=[];let c;for(;!(c=yield l.read()).done;)u.push(c.value);const d=u.reduce((e,t)=>e+t.length,0),_=new Uint8Array(d);let f=0;for(const e of u)_.set(e,f),f+=e.length;n.body=_,n.params=Object.assign(Object.assign({},null!==(e=n.params)&&void 0!==e?e:{}),{[o.NetworkParam.IsGzipped]:"1"})}catch(a){r.Log.warn(`Request compression failed for ${n.urlConfig.getUrl()}`,a)}})}_getInternalRequestArgs(e,t){const n=this._fallbackResolver.getActiveFallbackUrl(t.sdkKey,t.urlConfig),r=Object.assign(Object.assign({},t),{method:e,fallbackUrl:n});return"data"in t&&v(r,t.data),r}};const p=e=>!!e.sdkKey||(r.Log.warn("Unable to make request without an SDK key"),!1),v=(e,t)=>{const{sdkKey:n,fallbackUrl:r}=e,o=c.StableID.get(n),i=u.SessionID.get(n),s=a.SDKType._get(n);e.body=JSON.stringify(Object.assign(Object.assign({},t),{statsigMetadata:Object.assign(Object.assign({},_.StatsigMetadataProvider.get()),{stableID:o,sessionID:i,sdkType:s,fallbackUrl:r})}))};function m(e,t,r,i,s){e.urlConfig.endpoint===o.Endpoint._initialize&&n.Diagnostics._markInitNetworkReqEnd(e.sdkKey,n.Diagnostics._getDiagnosticsData(t,r,i,s))}return wt}var Ft,Kt={};var $t,zt={};var Bt,Vt={};var Gt,qt={};function Ht(){if(Gt)return qt;Gt=1;var e=qt&&qt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(qt,"__esModule",{value:!0}),qt.StatsigClientBase=void 0,te();const t=te(),n=dt(),r=Me(),o=ee(),i=bt(),s=be(),a=xt(),l=Je(),u=De(),c=Te();return qt.StatsigClientBase=class{constructor(e,i,u,d){var _,f,g,h;this.loadingStatus="Uninitialized",this._initializePromise=null,this._listeners={};const p=this.$emt.bind(this);null!=(null==d?void 0:d.logLevel)&&(o.Log.level=d.logLevel),(null==d?void 0:d.disableStorage)&&c.Storage._setDisabled(!0),(null==d?void 0:d.initialSessionID)&&a.StatsigSession.overrideInitialSessionID(d.initialSessionID,e),(null==d?void 0:d.storageProvider)&&c.Storage._setProvider(d.storageProvider),(null==d?void 0:d.enableCookies)&&l.StableID._setCookiesEnabled(e,d.enableCookies),(null==d?void 0:d.disableStableID)&&l.StableID._setDisabled(e,!0),this._sdkKey=e,this._options=null!=d?d:{},this._memoCache={},this.overrideAdapter=null!==(_=null==d?void 0:d.overrideAdapter)&&void 0!==_?_:null,this._logger=new r.EventLogger(e,p,u,d),this._errorBoundary=new n.ErrorBoundary(e,d,p),this._errorBoundary.wrap(this),this._errorBoundary.wrap(i),this._errorBoundary.wrap(this._logger),u.setErrorBoundary(this._errorBoundary),this.dataAdapter=i,this.dataAdapter.attach(e,d,u),this.storageProvider=c.Storage,null===(h=null===(g=null===(f=this.overrideAdapter)||void 0===f?void 0:f.loadFromStorage)||void 0===g?void 0:g.call(f))||void 0===h||h.catch(e=>this._errorBoundary.logError("OA::loadFromStorage",e)),this._primeReadyRipcord(),function(e,n){var r;if((0,s._isServerEnv)())return;const i=(0,t._getStatsigGlobal)(),a=null!==(r=i.instances)&&void 0!==r?r:{},l=n;null!=a[e]&&o.Log.warn("Creating multiple Statsig clients with the same SDK key can lead to unexpected behavior. Multi-instance support requires different SDK keys.");a[e]=l,i.firstInstance||(i.firstInstance=l);i.instances=a,__STATSIG__=i}(e,this)}updateRuntimeOptions(e){e.loggingEnabled?(this._options.loggingEnabled=e.loggingEnabled,this._logger.setLoggingEnabled(e.loggingEnabled)):null!=e.disableLogging&&(this._options.disableLogging=e.disableLogging,this._logger.setLoggingEnabled(e.disableLogging?"disabled":"browser-only")),null!=e.disableStorage&&(this._options.disableStorage=e.disableStorage,c.Storage._setDisabled(e.disableStorage)),null!=e.enableCookies&&(this._options.enableCookies=e.enableCookies,l.StableID._setCookiesEnabled(this._sdkKey,e.enableCookies)),e.logEventCompressionMode?this._logger.setLogEventCompressionMode(e.logEventCompressionMode):e.disableCompression&&this._logger.setLogEventCompressionMode(u.LogEventCompressionMode.Disabled)}flush(){return this._logger.flush()}shutdown(){return e(this,void 0,void 0,function*(){this.$emt({name:"pre_shutdown"}),this._setStatus("Uninitialized",null),this._initializePromise=null,yield this._logger.stop()})}on(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t)}off(e,t){if(this._listeners[e]){const n=this._listeners[e].indexOf(t);-1!==n&&this._listeners[e].splice(n,1)}}$on(e,t){t.__isInternal=!0,this.on(e,t)}$emt(e){var t;const n=t=>{try{t(e)}catch(n){if(!0===t.__isInternal)return void this._errorBoundary.logError(`__emit:${e.name}`,n);o.Log.error("An error occurred in a StatsigClientEvent listener. This is not an issue with Statsig.",e)}};this._listeners[e.name]&&this._listeners[e.name].forEach(e=>n(e)),null===(t=this._listeners["*"])||void 0===t||t.forEach(n)}_setStatus(e,t){this.loadingStatus=e,this._memoCache={},this.$emt({name:"values_updated",status:e,values:t})}_enqueueExposure(e,t,n){!0!==(null==n?void 0:n.disableExposureLog)?this._logger.enqueue(t):this._logger.incrementNonExposureCount(e)}_memoize(e,t){return(n,r)=>{if(this._options.disableEvaluationMemoization)return t(n,r);const o=(0,i.createMemoKey)(e,n,r);return o?(o in this._memoCache||(Object.keys(this._memoCache).length>=3e3&&(this._memoCache={}),this._memoCache[o]=t(n,r)),this._memoCache[o]):t(n,r)}}},qt}var Wt,Jt={};var Yt,Qt={};var Xt,Zt={};var en,tn={};var nn,rn,on={};function sn(){return rn||(rn=1,function(e){var t=Q&&Q.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=Q&&Q.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.Storage=e.Log=e.EventLogger=e.Diagnostics=void 0,te();const r=te(),o=oe();Object.defineProperty(e,"Diagnostics",{enumerable:!0,get:function(){return o.Diagnostics}});const i=Me();Object.defineProperty(e,"EventLogger",{enumerable:!0,get:function(){return i.EventLogger}});const s=ee();Object.defineProperty(e,"Log",{enumerable:!0,get:function(){return s.Log}});const a=Ke(),l=Te();Object.defineProperty(e,"Storage",{enumerable:!0,get:function(){return l.Storage}}),n(te(),e),n(ge(),e),n(($e||($e=1,Object.defineProperty(ze,"__esModule",{value:!0})),ze),e),n(rt(),e),n(oe(),e),n((ot||(ot=1,Object.defineProperty(it,"__esModule",{value:!0})),it),e),n(dt(),e),n((_t||(_t=1,Object.defineProperty(ft,"__esModule",{value:!0})),ft),e),n((gt||(gt=1,Object.defineProperty(ht,"__esModule",{value:!0})),ht),e),n(fe(),e),n((pt||(pt=1,Object.defineProperty(vt,"__esModule",{value:!0})),vt),e),n(ee(),e),n(bt(),e),n(ve(),e),n(Nt(),e),n((Ft||(Ft=1,Object.defineProperty(Kt,"__esModule",{value:!0})),Kt),e),n(($t||($t=1,Object.defineProperty(zt,"__esModule",{value:!0})),zt),e),n(be(),e),n(ct(),e),n(xt(),e),n((Bt||(Bt=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._fastApproxSizeOf=void 0,e._fastApproxSizeOf=(t,n)=>{let r=0;const o=Object.keys(t);for(let i=0;i<o.length;i++){const s=o[i],a=t[s];if(r+=s.length,r+="object"==typeof a&&null!==a?(0,e._fastApproxSizeOf)(a,n)+2:String(a).length+1,r>=n)return r}return r}}(Vt)),Vt),e),n(Je(),e),n(Ht(),e),n(Mt(),e),n((Wt||(Wt=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.DataAdapterCachePrefix=void 0,Jt.DataAdapterCachePrefix="statsig.cached"),Jt),e),n(we(),e),n(Ke(),e),n(De(),e),n((Yt||(Yt=1,Object.defineProperty(Qt,"__esModule",{value:!0})),Qt),e),n(function(){if(Xt)return Zt;Xt=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt._makeTypedGet=Zt._mergeOverride=Zt._makeLayer=Zt._makeExperiment=Zt._makeDynamicConfig=Zt._makeFeatureGate=void 0;const e=ee(),t=_e();function n(e,t,n,r){var o;return{name:e,details:t,ruleID:null!==(o=null==n?void 0:n.rule_id)&&void 0!==o?o:"",__evaluation:n,value:r}}function r(e,t,r){var i,s;const a=null!==(i=null==r?void 0:r.value)&&void 0!==i?i:{};return Object.assign(Object.assign({},n(e,t,r,a)),{idType:null!==(s=null==r?void 0:r.id_type)&&void 0!==s?s:null,get:o(e,null==r?void 0:r.value)})}function o(n,r,o){return(i,s)=>{var a;const l=null!==(a=null==r?void 0:r[i])&&void 0!==a?a:null;return null==l?null!=s?s:null:null==s||(0,t._isTypeMatch)(l,s)?(null==o||o(i),l):(e.Log.warn(`Parameter type mismatch. '${n}.${i}' was found to be type '${typeof l}' but fallback/return type is '${typeof s}'. See https://docs.statsig.com/client/javascript-sdk/#typed-getters`),null!=s?s:null)}}return Zt._makeFeatureGate=function(e,t,r){var o;return Object.assign(Object.assign({},n(e,t,r,!0===(null==r?void 0:r.value))),{idType:null!==(o=null==r?void 0:r.id_type)&&void 0!==o?o:null})},Zt._makeDynamicConfig=r,Zt._makeExperiment=function(e,t,n){var o;const i=r(e,t,n);return Object.assign(Object.assign({},i),{groupName:null!==(o=null==n?void 0:n.group_name)&&void 0!==o?o:null})},Zt._makeLayer=function(e,t,r,i){var s,a;return Object.assign(Object.assign({},n(e,t,r,void 0)),{get:o(e,null==r?void 0:r.value,i),groupName:null!==(s=null==r?void 0:r.group_name)&&void 0!==s?s:null,__value:null!==(a=null==r?void 0:r.value)&&void 0!==a?a:{}})},Zt._mergeOverride=function(e,t,n,r){return Object.assign(Object.assign(Object.assign({},e),t),{get:o(e.name,n,r)})},Zt._makeTypedGet=o,Zt}(),e),n((en||(en=1,Object.defineProperty(tn,"__esModule",{value:!0})),tn),e),n(Xe(),e),n(Te(),e),n(nt(),e),n(_e(),e),n(Re(),e),n(We(),e),n(Le(),e),n((nn||(nn=1,Object.defineProperty(on,"__esModule",{value:!0}),on.UPDATE_DETAIL_ERROR_MESSAGES=on.createUpdateDetails=void 0,on.createUpdateDetails=(e,t,n,r,o,i)=>({duration:n,source:t,success:e,error:r,sourceUrl:o,warnings:i}),on.UPDATE_DETAIL_ERROR_MESSAGES={NO_NETWORK_DATA:"No data was returned from the network. This may be due to a network timeout if a timeout value was specified in the options or ad blocker error."}),on),e),n(Pt(),e),Object.assign((0,r._getStatsigGlobal)(),{Log:s.Log,SDK_VERSION:a.SDK_VERSION})}(Q)),Q}var an,ln={},un={},cn={};var dn,_n,fn={};function gn(){if(_n)return un;_n=1,Object.defineProperty(un,"__esModule",{value:!0});const e=sn(),t=function(){if(an)return cn;an=1,Object.defineProperty(cn,"__esModule",{value:!0}),cn.V1InitializeContainer=void 0;const e=sn();return cn.V1InitializeContainer=class{constructor(e){this._values=e}getGate(e){return this._getResultFromLookup(this._values.feature_gates,e)}getConfig(e){return this._getResultFromLookup(this._values.dynamic_configs,e)}getLayer(e){return this._getResultFromLookup(this._values.layer_configs,e)}getParamStore(e){return this._getResultFromLookup(this._values.param_stores,e)}getConfigList(){return Object.keys(this._values.dynamic_configs)}getExposureMapping(){return this._values.exposures}_getResultFromLookup(t,n){var r,o;return t&&null!==(o=null!==(r=t[n])&&void 0!==r?r:t[(0,e._DJB2)(n)])&&void 0!==o?o:null}},cn}(),n=function(){if(dn)return fn;dn=1,Object.defineProperty(fn,"__esModule",{value:!0}),fn.V2InitializeContainer=void 0;const e=sn();return fn.V2InitializeContainer=class{constructor(e){this._values=e}getGate(e){var t,n,r;const o=this._getResultFromLookup(this._values.feature_gates,e);return o?{name:e,value:!0===o.v,rule_id:null!==(t=o.r)&&void 0!==t?t:"default",secondary_exposures:null!==(n=o.s)&&void 0!==n?n:[],id_type:null!==(r=o.i)&&void 0!==r?r:""}:null}getConfig(e){var t,n,r,o;const i=this._getResultFromLookup(this._values.dynamic_configs,e);return i?{name:e,value:null!==(t=this._values.values[i.v])&&void 0!==t?t:{},rule_id:i.r,secondary_exposures:null!==(n=i.s)&&void 0!==n?n:[],id_type:null!==(r=i.i)&&void 0!==r?r:"",is_user_in_experiment:!0===i.ue,passed:!0===i.p,group_name:null!==(o=i.gn)&&void 0!==o?o:void 0,is_experiment_active:!0===i.ea,group:i.r,is_device_based:"stableID"===i.i}:null}getLayer(e){var t,n,r,o,i,s;const a=this._getResultFromLookup(this._values.layer_configs,e);return a?{name:e,value:null!==(t=this._values.values[a.v])&&void 0!==t?t:{},rule_id:a.r,secondary_exposures:null!==(n=a.s)&&void 0!==n?n:[],is_user_in_experiment:!0===a.ue,group_name:null!==(r=a.gn)&&void 0!==r?r:void 0,is_experiment_active:!0===a.ea,group:a.r,is_device_based:"stableID"===a.i,allocated_experiment_name:null!==(o=a.ae)&&void 0!==o?o:"",explicit_parameters:null!==(i=a.ep)&&void 0!==i?i:[],undelegated_secondary_exposures:null!==(s=a.us)&&void 0!==s?s:[],parameter_rule_ids:a.pr}:null}getParamStore(e){return this._getResultFromLookup(this._values.param_stores,e)}getConfigList(){return Object.keys(this._values.dynamic_configs)}getExposureMapping(){return this._values.exposures}_getResultFromLookup(t,n){var r,o;return t&&null!==(o=null!==(r=t[n])&&void 0!==r?r:t[(0,e._DJB2)(n)])&&void 0!==o?o:null}},fn}();return un.default=class{constructor(e){this._sdkKey=e,this._rawValues=null,this._values=null,this._source="Uninitialized",this._lcut=0,this._receivedAt=0,this._bootstrapMetadata=null,this._warnings=new Set}reset(){this._values=null,this._rawValues=null,this._source="Loading",this._lcut=0,this._receivedAt=0,this._bootstrapMetadata=null,this._warnings.clear()}finalize(){this._values||(this._source="NoValues")}getValues(){return this._rawValues?(0,e._typedJsonParse)(this._rawValues,"has_updates","EvaluationStoreValues"):null}setValues(r,o){var i,s;if(!r)return!1;const a=(0,e._typedJsonParse)(r.data,"has_updates","EvaluationResponse");if(null==a)return!1;if(this._source=r.source,!0!==(null==a?void 0:a.has_updates))return!0;return(null!==(i=a.time)&&void 0!==i?i:0)<this._lcut||(this._rawValues=r.data,this._lcut=a.time,this._receivedAt=r.receivedAt,"init-v2"===a.response_format?this._values=new n.V2InitializeContainer(a):this._values=new t.V1InitializeContainer(a),this._bootstrapMetadata=this._extractBootstrapMetadata(r.source,a),r.source&&a.user&&this._setWarningState(o,a),e.SDKFlags.setFlags(this._sdkKey,null!==(s=a.sdk_flags)&&void 0!==s?s:{})),!0}getWarnings(){if(0!==this._warnings.size)return Array.from(this._warnings)}getGate(e){const t=this._values?this._values.getGate(e):null;return this._getDetailedStoreResult(t)}getConfig(e){const t=this._values?this._values.getConfig(e):null;return this._getDetailedStoreResult(t)}getConfigList(){return this._values?this._values.getConfigList():[]}getLayer(e){const t=this._values?this._values.getLayer(e):null;return this._getDetailedStoreResult(t)}getParamStore(e){const t=this._values?this._values.getParamStore(e):null;return this._getDetailedStoreResult(t)}getSource(){return this._source}getExposureMapping(){var e;return null===(e=this._values)||void 0===e?void 0:e.getExposureMapping()}_extractBootstrapMetadata(e,t){if("Bootstrap"!==e)return null;const n={};return t.user&&(n.user=t.user),t.sdkInfo&&(n.generatorSDKInfo=t.sdkInfo),n.lcut=t.time,n}_getDetailedStoreResult(e){return{result:e,details:this._getDetails(null==e)}}_setWarningState(t,n){var r,o;const i=e.StableID.get(this._sdkKey);if((null===(r=t.customIDs)||void 0===r?void 0:r.stableID)===i||!(null===(o=t.customIDs)||void 0===o?void 0:o.stableID)&&!i){if("user"in n){const r=n.user,o=Object.assign(Object.assign({},t),{analyticsOnlyMetadata:void 0,privateAttributes:void 0});(0,e._getFullUserHash)(o)!==(0,e._getFullUserHash)(r)&&this._warnings.add("PartialUserMatch")}}else this._warnings.add("StableIDMismatch")}getCurrentSourceDetails(){if("Uninitialized"===this._source||"NoValues"===this._source)return{reason:this._source};const e={reason:this._source,lcut:this._lcut,receivedAt:this._receivedAt};return this._warnings.size>0&&(e.warnings=Array.from(this._warnings)),e}_getDetails(e){var t,n;const r=this.getCurrentSourceDetails();let o=r.reason;const i=null!==(t=r.warnings)&&void 0!==t?t:[];if("Bootstrap"===this._source&&i.length>0&&(o+=i[0]),"Uninitialized"!==o&&"NoValues"!==o){o=`${o}:${e?"Unrecognized":"Recognized"}`}const s="Bootstrap"===this._source&&null!==(n=this._bootstrapMetadata)&&void 0!==n?n:void 0;return s&&(r.bootstrapMetadata=s),Object.assign(Object.assign({},r),{reason:o})}},un}var hn,pn,vn={},mn={};function yn(){if(hn)return mn;hn=1,Object.defineProperty(mn,"__esModule",{value:!0}),mn._resolveDeltasResponse=void 0;const e=sn();function t(e,t){null==e||e.forEach(e=>{delete t[e]})}return mn._resolveDeltasResponse=function(n,r){const o=(0,e._typedJsonParse)(r,"checksum","DeltasEvaluationResponse");if(!o)return{hadBadDeltaChecksum:!0};const i=function(e){const n=e;return t(e.deleted_gates,n.feature_gates),delete n.deleted_gates,t(e.deleted_configs,n.dynamic_configs),delete n.deleted_configs,t(e.deleted_layers,n.layer_configs),delete n.deleted_layers,n}(function(e,t){return Object.assign(Object.assign(Object.assign({},e),t),{feature_gates:Object.assign(Object.assign({},e.feature_gates),t.feature_gates),layer_configs:Object.assign(Object.assign({},e.layer_configs),t.layer_configs),dynamic_configs:Object.assign(Object.assign({},e.dynamic_configs),t.dynamic_configs)})}(n,o)),s=(0,e._DJB2Object)({feature_gates:i.feature_gates,dynamic_configs:i.dynamic_configs,layer_configs:i.layer_configs},2);return s===o.checksumV2?JSON.stringify(i):{hadBadDeltaChecksum:!0,badChecksum:s,badMergedConfigs:i,badFullResponse:o.deltas_full_response}},mn}function bn(){if(pn)return vn;pn=1;var e=vn&&vn.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(vn,"__esModule",{value:!0});const t=sn(),n=yn();class r extends t.NetworkCore{constructor(e,n){super(e,n);const r=null==e?void 0:e.networkConfig;this._option=e,this._initializeUrlConfig=new t.UrlConfiguration(t.Endpoint._initialize,null==r?void 0:r.initializeUrl,null==r?void 0:r.api,null==r?void 0:r.initializeFallbackUrls)}fetchEvaluations(n,r,o,i,s){return e(this,void 0,void 0,function*(){var e,a,l,u,c,d;const _=r?(0,t._typedJsonParse)(r,"has_updates","InitializeResponse"):null;let f={user:i,hash:null!==(l=null===(a=null===(e=this._option)||void 0===e?void 0:e.networkConfig)||void 0===a?void 0:a.initializeHashAlgorithm)&&void 0!==l?l:"djb2",deltasResponseRequested:!1,full_checksum:null};if(null==_?void 0:_.has_updates){const e=(null==_?void 0:_.hash_used)!==(null!==(d=null===(c=null===(u=this._option)||void 0===u?void 0:u.networkConfig)||void 0===c?void 0:c.initializeHashAlgorithm)&&void 0!==d?d:"djb2");f=Object.assign(Object.assign({},f),{sinceTime:s&&!e?_.time:0,previousDerivedFields:"derived_fields"in _&&s?_.derived_fields:{},deltasResponseRequested:!0,full_checksum:_.full_checksum,partialUserMatchSinceTime:e?0:_.time})}return this._fetchEvaluations(n,_,f,o)})}_fetchEvaluations(t,r,o,i){return e(this,void 0,void 0,function*(){var e,s;const a=yield this.post({sdkKey:t,urlConfig:this._initializeUrlConfig,data:o,retries:2,isStatsigEncodable:!0,priority:i});if(204===(null==a?void 0:a.code))return'{"has_updates": false}';if(200!==(null==a?void 0:a.code))return null!==(e=null==a?void 0:a.body)&&void 0!==e?e:null;if(!0!==(null==r?void 0:r.has_updates)||!0!==(null===(s=a.body)||void 0===s?void 0:s.includes('"is_delta":true'))||!0!==o.deltasResponseRequested)return a.body;const l=(0,n._resolveDeltasResponse)(r,a.body);return"string"==typeof l?l:this._fetchEvaluations(t,r,Object.assign(Object.assign(Object.assign({},o),l),{deltasResponseRequested:!1}),i)})}}return vn.default=r,vn}var Sn,En={};function wn(){if(Sn)return En;Sn=1,Object.defineProperty(En,"__esModule",{value:!0}),En._makeParamStoreGetter=void 0;const e=sn(),t={disableExposureLog:!0};function n(e){return null==e||!1===e.disableExposureLog}function r(t,n){return null!=n&&!(0,e._isTypeMatch)(t,n)}return En._makeParamStoreGetter=function(o,i,s){return(a,l)=>{if(null==i)return l;const u=i[a];if(null==u||null!=l&&(0,e._typeOf)(l)!==u.param_type)return l;switch(u.ref_type){case"static":return function(e){return e.value}(u);case"gate":return function(e,r,o){return e.getFeatureGate(r.gate_name,n(o)?void 0:t).value?r.pass_value:r.fail_value}(o,u,s);case"dynamic_config":return function(e,o,i,s){const a=e.getDynamicConfig(o.config_name,n(s)?void 0:t).get(o.param_name);return r(a,i)?i:a}(o,u,l,s);case"experiment":return function(e,o,i,s){const a=e.getExperiment(o.experiment_name,n(s)?void 0:t).get(o.param_name);return r(a,i)?i:a}(o,u,l,s);case"layer":return function(e,o,i,s){const a=e.getLayer(o.layer_name,n(s)?void 0:t).get(o.param_name);return r(a,i)?i:a}(o,u,l,s);default:return l}}},En}var kn,On,Dn,In={};function Cn(){if(kn)return In;kn=1;var e=In&&In.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(In,"__esModule",{value:!0}),In.StatsigEvaluationsDataAdapter=void 0;const t=sn(),n=bn();let r=class extends t.DataAdapterCore{constructor(){super("EvaluationsDataAdapter","evaluations"),this._network=null,this._options=null}attach(e,t,r){super.attach(e,t,r),null!==r&&r instanceof n.default?this._network=r:this._network=new n.default(null!=t?t:{})}getDataAsync(e,n,r){return this._getDataAsyncImpl(e,(0,t._normalizeUser)(n,this._options),r)}prefetchData(e,t){return this._prefetchDataImpl(e,t)}setData(e){const n=(0,t._typedJsonParse)(e,"has_updates","data");n&&"user"in n?super.setData(e,n.user):t.Log.error("StatsigUser not found. You may be using an older server SDK version. Please upgrade your SDK or use setDataLegacy.")}setDataLegacy(e,t){super.setData(e,t)}_fetchFromNetwork(t,n,r,o){return e(this,void 0,void 0,function*(){var e;const i=yield null===(e=this._network)||void 0===e?void 0:e.fetchEvaluations(this._getSdkKey(),t,null==r?void 0:r.priority,n,o);return null!=i?i:null})}_getCacheKey(e){var n;const r=(0,t._getStorageKey)(this._getSdkKey(),e,null===(n=this._options)||void 0===n?void 0:n.customUserCacheKeyFunc);return`${t.DataAdapterCachePrefix}.${this._cacheSuffix}.${r}`}_isCachedResultValidFor204(e,n){return null!=e.fullUserHash&&e.fullUserHash===(0,t._getFullUserHash)(n)}};return In.StatsigEvaluationsDataAdapter=r,In}function Tn(){if(On)return ln;On=1;var e=ln&&ln.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};Object.defineProperty(ln,"__esModule",{value:!0});const t=sn(),n=gn(),r=bn(),o=wn(),i=Cn();let s=class s extends t.StatsigClientBase{static instance(e){const n=(0,t._getStatsigGlobal)().instance(e);return n instanceof s?n:(t.Log.warn((0,t._isServerEnv)()?"StatsigClient.instance is not supported in server environments":"Unable to find StatsigClient instance"),new s(null!=e?e:"",{}))}constructor(e,o,s=null){var a,l;t.SDKType._setClientType(e,"javascript-client");const u=new r.default(s,e=>{this.$emt(e)});super(e,null!==(a=null==s?void 0:s.dataAdapter)&&void 0!==a?a:new i.StatsigEvaluationsDataAdapter,u,s),this._possibleFirstTouchMetadata={},this.getFeatureGate=this._memoize(t.MemoPrefix._gate,this._getFeatureGateImpl.bind(this)),this.getDynamicConfig=this._memoize(t.MemoPrefix._dynamicConfig,this._getDynamicConfigImpl.bind(this)),this.getExperiment=this._memoize(t.MemoPrefix._experiment,this._getExperimentImpl.bind(this)),this.getConfigList=this._memoize(t.MemoPrefix._configList,this._getConfigListImpl.bind(this)),this.getLayer=this._memoize(t.MemoPrefix._layer,this._getLayerImpl.bind(this)),this.getParameterStore=this._memoize(t.MemoPrefix._paramStore,this._getParameterStoreImpl.bind(this)),this._store=new n.default(e),this._network=u,this._user=this._configureUser(o,s),this._sdkInstanceID=(0,t.getUUID)();const c=null!==(l=null==s?void 0:s.plugins)&&void 0!==l?l:[];for(const t of c)t.bind(this)}initializeSync(e){var n;return"Uninitialized"!==this.loadingStatus?(0,t.createUpdateDetails)(!0,this._store.getSource(),-1,null,null,["MultipleInitializations",...null!==(n=this._store.getWarnings())&&void 0!==n?n:[]]):(this._logger.start(),this.updateUserSync(this._user,e))}initializeAsync(t){return e(this,void 0,void 0,function*(){return this._initializePromise||(this._initializePromise=this._initializeAsyncImpl(t)),this._initializePromise})}updateUserSync(e,t){const n=performance.now();try{return this._updateUserSyncImpl(e,t,n)}catch(r){const e=r instanceof Error?r:new Error(String(r));return this._createErrorUpdateDetails(e,n)}}_updateUserSyncImpl(e,n,r){var o;const i=[...null!==(o=this._store.getWarnings())&&void 0!==o?o:[]];this._resetForUser(e);const s=this.dataAdapter.getDataSync(this._user);null==s&&i.push("NoCachedValues"),this._store.setValues(s,this._user),this._finalizeUpdate(s);const a=null==n?void 0:n.disableBackgroundCacheRefresh;return!0===a||null==a&&"Bootstrap"===(null==s?void 0:s.source)||this._runPostUpdate(null!=s?s:null,this._user),(0,t.createUpdateDetails)(!0,this._store.getSource(),performance.now()-r,this._errorBoundary.getLastSeenErrorAndReset(),this._network.getLastUsedInitUrlAndReset(),i)}updateUserAsync(t,n){return e(this,void 0,void 0,function*(){const e=performance.now();try{return yield this._updateUserAsyncImpl(t,n)}catch(r){const t=r instanceof Error?r:new Error(String(r));return this._createErrorUpdateDetails(t,e)}})}_updateUserAsyncImpl(n,r){return e(this,void 0,void 0,function*(){this._resetForUser(n);const e=this._user;t.Diagnostics._markInitOverallStart(this._sdkKey);let o=this.dataAdapter.getDataSync(e);if(this._store.setValues(o,this._user),this._setStatus("Loading",o),o=yield this.dataAdapter.getDataAsync(o,e,r),e!==this._user)return(0,t.createUpdateDetails)(!1,this._store.getSource(),-1,new Error("User changed during update"),this._network.getLastUsedInitUrlAndReset());let i=!1;null!=o&&(t.Diagnostics._markInitProcessStart(this._sdkKey),i=this._store.setValues(o,this._user),t.Diagnostics._markInitProcessEnd(this._sdkKey,{success:i})),this._finalizeUpdate(o),i||(this._errorBoundary.attachErrorIfNoneExists(t.UPDATE_DETAIL_ERROR_MESSAGES.NO_NETWORK_DATA),this.$emt({name:"initialization_failure"})),t.Diagnostics._markInitOverallEnd(this._sdkKey,i,this._store.getCurrentSourceDetails());const s=t.Diagnostics._enqueueDiagnosticsEvent(this._user,this._logger,this._sdkKey,this._options);return(0,t.createUpdateDetails)(i,this._store.getSource(),s,this._errorBoundary.getLastSeenErrorAndReset(),this._network.getLastUsedInitUrlAndReset(),this._store.getWarnings())})}getContext(){return{sdkKey:this._sdkKey,options:this._options,values:this._store.getValues(),user:JSON.parse(JSON.stringify(this._user)),errorBoundary:this._errorBoundary,session:t.StatsigSession.get(this._sdkKey),stableID:t.StableID.get(this._sdkKey),sdkInstanceID:this._sdkInstanceID}}checkGate(e,t){return this.getFeatureGate(e,t).value}logEvent(e,t,n){const r="string"==typeof e?{eventName:e,value:t,metadata:n}:e;this.$emt({name:"log_event_called",event:r}),this._logger.enqueue(Object.assign(Object.assign({},r),{user:this._user,time:Date.now()}))}updateUserWithAnalyticsOnlyMetadata(e){this._user=this._configureUser(Object.assign(Object.assign({},this._user),{analyticsOnlyMetadata:e}),this._options)}_primeReadyRipcord(){this.$on("error",()=>{"Loading"===this.loadingStatus&&this._finalizeUpdate(null)})}_initializeAsyncImpl(n){return e(this,void 0,void 0,function*(){return t.Storage.isReady()||(yield t.Storage.isReadyResolver()),this._logger.start(),this.updateUserAsync(this._user,n)})}_createErrorUpdateDetails(e,n){var r;return(0,t.createUpdateDetails)(!1,this._store.getSource(),performance.now()-n,e,null,[...null!==(r=this._store.getWarnings())&&void 0!==r?r:[]])}_finalizeUpdate(e){this._store.finalize(),this._setStatus("Ready",e)}_runPostUpdate(e,n){this.dataAdapter.getDataAsync(e,n,{priority:"low"}).catch(e=>{t.Log.error("An error occurred after update.",e)})}_resetForUser(e){this._logger.reset(),this._store.reset(),this._user=this._configureUser(e,this._options)}_configureUser(e,n){var r,o,i;const s=(0,t._normalizeUser)(e,n),a=null===(r=s.customIDs)||void 0===r?void 0:r.stableID;if(a){const e=null===(i=(o=this.storageProvider).isReadyResolver)||void 0===i?void 0:i.call(o);e?e.then(()=>t.StableID.setOverride(a,this._sdkKey),()=>t.StableID.setOverride(a,this._sdkKey)):t.StableID.setOverride(a,this._sdkKey)}return Object.keys(this._possibleFirstTouchMetadata).length>0&&(s.analyticsOnlyMetadata=Object.assign(Object.assign({},s.analyticsOnlyMetadata),this._possibleFirstTouchMetadata)),s}_getFeatureGateImpl(e,n){var r,o;const{result:i,details:s}=this._store.getGate(e),a=(0,t._makeFeatureGate)(e,s,i),l=null===(o=null===(r=this.overrideAdapter)||void 0===r?void 0:r.getGateOverride)||void 0===o?void 0:o.call(r,a,this._user,n),u=null!=l?l:a;return this._enqueueExposure(e,(0,t._createGateExposure)(this._user,u,this._store.getExposureMapping()),n),this.$emt({name:"gate_evaluation",gate:u}),u}_getDynamicConfigImpl(e,n){var r,o;const{result:i,details:s}=this._store.getConfig(e),a=(0,t._makeDynamicConfig)(e,s,i),l=null===(o=null===(r=this.overrideAdapter)||void 0===r?void 0:r.getDynamicConfigOverride)||void 0===o?void 0:o.call(r,a,this._user,n),u=null!=l?l:a;return this._enqueueExposure(e,(0,t._createConfigExposure)(this._user,u,this._store.getExposureMapping()),n),this.$emt({name:"dynamic_config_evaluation",dynamicConfig:u}),u}_getExperimentImpl(e,n){var r,o,i,s;const{result:a,details:l}=this._store.getConfig(e),u=(0,t._makeExperiment)(e,l,a);null!=u.__evaluation&&(u.__evaluation.secondary_exposures=(0,t._mapExposures)(null!==(o=null===(r=u.__evaluation)||void 0===r?void 0:r.secondary_exposures)&&void 0!==o?o:[],this._store.getExposureMapping()));const c=null===(s=null===(i=this.overrideAdapter)||void 0===i?void 0:i.getExperimentOverride)||void 0===s?void 0:s.call(i,u,this._user,n),d=null!=c?c:u;return this._enqueueExposure(e,(0,t._createConfigExposure)(this._user,d,this._store.getExposureMapping()),n),this.$emt({name:"experiment_evaluation",experiment:d}),d}_getConfigListImpl(){return this._store.getConfigList()}_getLayerImpl(e,n){var r,o,i;const{result:s,details:a}=this._store.getLayer(e),l=(0,t._makeLayer)(e,a,s),u=null===(o=null===(r=this.overrideAdapter)||void 0===r?void 0:r.getLayerOverride)||void 0===o?void 0:o.call(r,l,this._user,n);(null==n?void 0:n.disableExposureLog)&&this._logger.incrementNonExposureCount(e);const c=(0,t._mergeOverride)(l,u,null!==(i=null==u?void 0:u.__value)&&void 0!==i?i:l.__value,r=>{(null==n?void 0:n.disableExposureLog)||this._enqueueExposure(e,(0,t._createLayerParameterExposure)(this._user,c,r,this._store.getExposureMapping()),n)});return this.$emt({name:"layer_evaluation",layer:c}),c}_getParameterStoreImpl(e,t){var n,r;const{result:i,details:s}=this._store.getParamStore(e);this._logger.incrementNonExposureCount(e);const a={name:e,details:s,__configuration:i,get:(0,o._makeParamStoreGetter)(this,i,t)},l=null===(r=null===(n=this.overrideAdapter)||void 0===n?void 0:n.getParamStoreOverride)||void 0===r?void 0:r.call(n,a,t);return null!=l&&(a.__configuration=l.config,a.details=l.details,a.get=(0,o._makeParamStoreGetter)(this,l.config,t)),a}};return ln.default=s,ln}var Pn=(Dn||(Dn=1,function(e){var t=Y&&Y.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=Y&&Y.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.StatsigClient=void 0;const r=sn(),o=Tn();e.StatsigClient=o.default,n(sn(),e);const i=Object.assign((0,r._getStatsigGlobal)(),{StatsigClient:o.default});e.default=i}(Y)),Y);let An=null;const Rn=async()=>{try{const e=await Bn();if(!e)return null;const t=`${H().apiBaseUrl}/api/oauth/profile`,n=await fetch(t,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!n.ok)return null;return await n.json()}catch{return null}},xn=async e=>{let t=await y(m.ANONYMOUS_ID);t||(t=crypto.randomUUID(),await b(m.ANONYMOUS_ID,t));const n=chrome.runtime.getManifest().version;return e?{userID:e.account.uuid,customIDs:{anonymousID:t,organizationID:e.organization.uuid,organizationUUID:e.organization.uuid,applicationSlug:"claude-browser-use"},custom:{extensionVersion:n,isMax:e.account.has_claude_max,isPro:e.account.has_claude_pro,orgType:e.organization.organization_type},privateAttributes:{email:e.account.email}}:{customIDs:{anonymousID:t},custom:{extensionVersion:n}}},Un=async()=>{if(!An)try{const e=H(),t=await Rn(),n=await xn(t),r={environment:{tier:"production"===e.environment?"production":"development"}};An=new Pn.StatsigClient(e.statsigClientApiKey||"",n,r),await An.initializeAsync()}catch(e){}},jn=async()=>{if(An)try{const e=await Rn(),t=await xn(e);await An.updateUserAsync(t)}catch(e){}},Ln=e=>{if(!An)return{get:(e,t="")=>t};return An.getDynamicConfig(e)},Mn=async e=>{try{if(An||await Un(),An){return An.getFeatureGate(e).value}}catch(t){}return!1};async function Nn(e){try{if(An||await Un(),An){return An.getDynamicConfig(e).value}}catch(t){}return{}}const Fn=e=>btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),Kn=async(e,t)=>{await w({[m.ACCESS_TOKEN]:e.accessToken,[m.REFRESH_TOKEN]:e.refreshToken,[m.TOKEN_EXPIRY]:e.expiresAt,[m.OAUTH_STATE]:t})},$n=async(e,t)=>{try{const n=await fetch(t.TOKEN_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",client_id:t.CLIENT_ID,refresh_token:e})});if(!n.ok){const e=await n.text();return{success:!1,error:`Token refresh failed: ${n.status} ${e}`}}const r=await n.json();return r.error?{success:!1,error:r.error_description||r.error}:{success:!0,accessToken:r.access_token,refreshToken:r.refresh_token||e,expiresAt:r.expires_in?Date.now()+1e3*r.expires_in:void 0}}catch(n){return{success:!1,error:n instanceof Error?n.message:"Network error during token refresh"}}},zn=async()=>{try{const e=await E([m.ACCESS_TOKEN,m.REFRESH_TOKEN,m.TOKEN_EXPIRY]);if(!e[m.ACCESS_TOKEN])return{isValid:!1,isRefreshed:!1};const t=Date.now(),n=e[m.TOKEN_EXPIRY],r=!!n&&t<n;if(!(!!n&&t>=n-36e5))return{isValid:r,isRefreshed:!1};if(!e[m.REFRESH_TOKEN])return{isValid:r,isRefreshed:!1};const o=H();for(let i=0;i<3;i++){const t=await $n(e[m.REFRESH_TOKEN],o.oauth);if(t.success)return await Kn(t),{isValid:!0,isRefreshed:!0};if(2===i)return await S([m.ACCESS_TOKEN,m.REFRESH_TOKEN,m.TOKEN_EXPIRY]),{isValid:r,isRefreshed:!1}}return{isValid:r,isRefreshed:!1}}catch{return{isValid:!1,isRefreshed:!1}}},Bn=async()=>{if(!(await zn()).isValid)return;return await y(m.ACCESS_TOKEN)||void 0},Vn=async(e,t)=>{try{const n=new URLSearchParams(new URL(e).search),r=n.get("code"),o=n.get("error"),i=n.get("error_description"),s=n.get("state");if(o){return{success:!1,error:`Authentication failed: ${o}${i?" - "+i:""}`}}if(!r)return{success:!1,error:"No authorization code received"};const a=await y(m.CODE_VERIFIER)||"",l=H(),u=await(async(e,t,n,r)=>{try{const o=await fetch(r.TOKEN_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"authorization_code",client_id:r.CLIENT_ID,code:e,redirect_uri:r.REDIRECT_URI,state:t,code_verifier:n})});if(!o.ok){const e=await o.text();return{success:!1,error:`Token exchange failed: ${o.status} ${e}`}}const i=await o.json();return i.error?{success:!1,error:i.error_description||i.error}:{success:!0,accessToken:i.access_token,refreshToken:i.refresh_token,expiresAt:i.expires_in?Date.now()+1e3*i.expires_in:void 0}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Network error during token exchange"}}})(r,s||"",a,l.oauth);if(u.success){await Kn(u,s||void 0),await jn();const e="https://claude.ai/chrome/installed";return t&&await chrome.tabs.update(t,{url:e}),{success:!0,message:"Authentication successful!"}}return{success:!1,error:u.error||"Failed to exchange authorization code for token"}}catch(n){return{success:!1,error:n instanceof Error?n.message:"An unexpected error occurred during authentication"}}},Gn=async()=>{await O()},qn=async()=>{const e=H(),t=(e=>{const t=new Uint8Array(e);return crypto.getRandomValues(t),Fn(t)})(32),n=Fn(crypto.getRandomValues(new Uint8Array(32))),r=await(async e=>{const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t);return Fn(new Uint8Array(n))})(n);await w({[m.OAUTH_STATE]:t,[m.CODE_VERIFIER]:n});const o=new URLSearchParams({client_id:e.oauth.CLIENT_ID,response_type:"code",scope:e.oauth.SCOPES_STR,redirect_uri:e.oauth.REDIRECT_URI,state:t,code_challenge:r,code_challenge_method:"S256"}),i=`${e.oauth.AUTHORIZE_URL}?${o.toString()}`;chrome.tabs.create({url:i})},Hn=async()=>{let e=await y(m.ANONYMOUS_ID);return e||(e=crypto.randomUUID(),await b(m.ANONYMOUS_ID,e)),e},Wn=e=>({email:e.account.email,organizationID:e.organization.uuid,organizationUUID:e.organization.uuid,applicationSlug:"claude-browser-use",isMax:e.account.has_claude_max,isPro:e.account.has_claude_pro,orgType:e.organization.organization_type});var Jn=(e=>(e.ALLOW="allow",e.DENY="deny",e))(Jn||{}),Yn=(e=>(e.ONCE="once",e.ALWAYS="always",e))(Yn||{});function Qn(e){return{[z.NAVIGATE]:"navigate to",[z.READ_PAGE_CONTENT]:"read page content on",[z.READ_CONSOLE_MESSAGES]:"read debugging information on",[z.READ_NETWORK_REQUESTS]:"read debugging information on",[z.CLICK]:"click on",[z.TYPE]:"type text into",[z.UPLOAD_IMAGE]:"upload an image to",[z.DOMAIN_TRANSITION]:"navigate from",[z.PLAN_APPROVAL]:"approve plan for",[z.EXECUTE_JAVASCRIPT]:"execute JavaScript on",[z.REMOTE_MCP]:"access"}[e]}const Xn=["follow_a_plan","skip_all_permission_checks"],Zn="follow_a_plan";export{jn as A,Un as B,Gn as C,Zn as D,Vn as E,Nn as F,Wn as G,Mn as H,Jn as I,n as J,$ as K,Yn as P,p as R,m as S,z as T,Xn as U,I as _,K as a,g as b,t as c,Hn as d,Ln as e,H as f,y as g,Qn as h,Bn as i,c as j,zn as k,E as l,qn as m,a as n,S as o,v as p,P as q,h as r,b as s,A as t,U as u,T as v,j as w,F as x,R as y,x as z};
