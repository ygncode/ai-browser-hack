function h(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=Math.floor(256/e.length)*e.length,t=[];for(;t.length<22;){const n=new Uint8Array(16);crypto.getRandomValues(n);for(const o of n){if(o>=s)continue;const a=o%e.length;if(t.push(e[a]),t.length===22)break}}return t.join("")}function d(r,e){const s=`${e}/my-browser`;return{socketEndpoint:r,webAppDomain:e,onboardingUrl:`${e}/my-browser`,loginUrl:`${e}/login?redirectUrl=${encodeURIComponent(s)}`,appUrl:`${e}/app`,startTaskUrl:`${e}/my-browser?step=new-task`,securityUrl:`${e}/my-browser?step=security`,tutorialUrl:`${e}/my-browser?step=usage`,settingsUrl:`${e}/my-browser?step=settings`,feedbackUrl:`${e}/feedback?issueType=CONNECTOR&secondaryType=PROVIDE_FEEDBACK&connectorId=be268223-40b2-4f3c-a907-c12eb1699283`}}const m="https://vida.butterfly-effect.dev",$="https://manus.im",v={local:d("http://localhost:4000",m),dev:d("wss://vida.butterfly-effect.dev",m),prod:d("wss://api.manus.im",$)};class y{getEnv(){return"prod"}getEnvParams(){const e=this.getEnv();return{env:e,...v[e]}}isDev(){return this.getEnv()==="dev"||this.getEnv()==="local"}isProd(){return this.getEnv()==="prod"}}const b=new y,w="[ManusOperator]",E={debug:10,info:20,warn:30,error:40};function T(r){const e=b.isDev()?"debug":"warn";return E[r]>=E[e]}function M(r,e,s){const[t,...n]=s;return typeof t=="string"?[`${r} [${e.toUpperCase()}] ${t}`,...n]:[`${r} [${e.toUpperCase()}]`,t,...n]}function S(r){const e=w,s=(t,n)=>(...o)=>{T(t)&&n.apply(console,M(e,t,o))};return{debug:s("debug",console.debug),info:s("info",console.info),warn:s("warn",console.warn),error:s("error",console.error)}}const c=S(),f={silent:!1,slowThreshold:1e3,logLevel:"debug"};function p(r){return r&&typeof r=="object"&&"type"in r?String(r.type):"unknown"}function U(r,e){const s={...f,...e},t=h(),n=p(r),o=Date.now();return s.silent||(s.logLevel==="info"?c.info:c.debug)(`[${t}] Sending ${n}`,{message:r}),new Promise((a,l)=>{chrome.runtime.sendMessage(r,i=>{if(chrome.runtime.lastError){const g=chrome.runtime.lastError.message;c.error(`[${t}] Failed to send ${n}:`,g),l(new Error(g));return}const u=Date.now()-o;s.silent||(s.logLevel==="info"?c.info:c.debug)(`[${t}] Received response for ${n} in ${u}ms`,{response:i}),u>s.slowThreshold&&!s.silent&&c.warn(`[Performance] Slow message: ${n} took ${u}ms (threshold: ${s.slowThreshold}ms)`),a(i)})})}function I(r,e){const s={...f,...e},t=h(),n=p(r);chrome.runtime.sendMessage(r,()=>{if(chrome.runtime.lastError&&!s.silent){const o=chrome.runtime.lastError.message;!o.includes("Could not establish connection")&&!o.includes("Receiving end does not exist")&&c.warn(`[${t}] Broadcast ${n} failed:`,o)}})}function _(r,e,s){const t={...f,...s},n={...e,messageTimestamp:Date.now()};return new Promise((o,a)=>{chrome.tabs.sendMessage(r,n,l=>{if(chrome.runtime.lastError){const i=chrome.runtime.lastError.message;t.silent||c.error(`Failed to send message to tab ${r}:`,i),a(new Error(i));return}o(l)})})}export{_ as a,I as b,b as e,h as g,c as l,U as s};
